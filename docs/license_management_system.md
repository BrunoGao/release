# LJWX License ç®¡ç†ç³»ç»Ÿå®Œæ•´è§£å†³æ–¹æ¡ˆ

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
3. [æ ¸å¿ƒåŠŸèƒ½](#æ ¸å¿ƒåŠŸèƒ½)
4. [éƒ¨ç½²æŒ‡å—](#éƒ¨ç½²æŒ‡å—)
5. [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
6. [APIæ–‡æ¡£](#apiæ–‡æ¡£)
7. [æ•…éšœæ’é™¤](#æ•…éšœæ’é™¤)
8. [æœ€ä½³å®è·µ](#æœ€ä½³å®è·µ)

## ç³»ç»Ÿæ¦‚è¿°

LJWX Licenseç®¡ç†ç³»ç»Ÿæ˜¯ä¸€å¥—å®Œæ•´çš„è½¯ä»¶æˆæƒç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒå¤šç§Ÿæˆ·æ¶æ„ï¼Œæä¾›è®¾å¤‡æ•°é‡é™åˆ¶ã€å¹¶å‘æ§åˆ¶ã€åŠŸèƒ½æƒé™ç®¡ç†ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚ç³»ç»Ÿåˆ†ä¸ºä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼š

- **ljwx-boot**: åç«¯LicenseæœåŠ¡ï¼Œæä¾›LicenseéªŒè¯ã€ç§Ÿæˆ·ç®¡ç†ã€ç»Ÿè®¡ç›‘æ§
- **ljwx-bigscreen**: å¤§å±ç³»ç»ŸLicenseé›†æˆï¼Œå®ç°è®¾å¤‡æ¥å…¥æ§åˆ¶å’Œå¹¶å‘é™åˆ¶
- **ljwx-admin**: å‰ç«¯ç®¡ç†ç•Œé¢ï¼Œæä¾›Licenseé…ç½®ã€ç›‘æ§ã€å¯¼å…¥ç­‰åŠŸèƒ½

### ğŸ¯ æ ¸å¿ƒä»·å€¼

- **è®¾å¤‡é™åˆ¶**: ç²¾ç¡®æ§åˆ¶æ¥å…¥è®¾å¤‡æ•°é‡ï¼Œé˜²æ­¢è¶…å‡ºLicenseèŒƒå›´
- **å¹¶å‘æ§åˆ¶**: å®æ—¶ç›‘æ§å¹¶å‘è¯·æ±‚ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šè¿è¡Œ
- **å¤šç§Ÿæˆ·æ”¯æŒ**: æ”¯æŒç§Ÿæˆ·çº§åˆ«çš„Licenseé…ç½®å’Œæƒé™æ§åˆ¶
- **å®æ—¶ç›‘æ§**: æä¾›è¯¦ç»†çš„ä½¿ç”¨ç»Ÿè®¡å’Œå‘Šè­¦æœºåˆ¶
- **çµæ´»ç®¡ç†**: æ”¯æŒLicenseå¯¼å…¥ã€åœ¨çº¿é…ç½®ã€æ‰¹é‡ç®¡ç†

## æ¶æ„è®¾è®¡

### ğŸ—ï¸ æ•´ä½“æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ljwx-admin    â”‚    â”‚   ljwx-boot     â”‚    â”‚ ljwx-bigscreen  â”‚
â”‚   å‰ç«¯ç®¡ç†ç•Œé¢     â”‚    â”‚   LicenseæœåŠ¡    â”‚    â”‚   å¤§å±è®¾å¤‡æ¥å…¥    â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ è¶…çº§ç®¡ç†å‘˜   â”‚ â”‚    â”‚ â”‚ License     â”‚ â”‚    â”‚ â”‚ License     â”‚ â”‚
â”‚ â”‚ Licenseç®¡ç†  â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ Manager     â”‚ â”‚â—„â”€â”€â–ºâ”‚ â”‚ Manager     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ç§Ÿæˆ·ç®¡ç†å‘˜   â”‚ â”‚    â”‚ â”‚ Customer    â”‚ â”‚    â”‚ â”‚ Device      â”‚ â”‚
â”‚ â”‚ LicenseæŸ¥çœ‹  â”‚ â”‚    â”‚ â”‚ License     â”‚ â”‚    â”‚ â”‚ Monitor     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â”‚ â”‚ Service     â”‚ â”‚    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚                 â”‚
                       â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
                       â”‚ â”‚ License     â”‚ â”‚
                       â”‚ â”‚ Validation  â”‚ â”‚
                       â”‚ â”‚ & Control   â”‚ â”‚
                       â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“Š æ•°æ®æµå›¾

```
è®¾å¤‡è¯·æ±‚ â†’ BigScreen LicenseéªŒè¯ â†’ Boot License API â†’ æ•°æ®åº“éªŒè¯ â†’ è¿”å›ç»“æœ
    â†“
è®¾å¤‡æ³¨å†Œ â†’ è®¾å¤‡è®¡æ•°æ›´æ–° â†’ Redisç¼“å­˜ â†’ å®æ—¶ç›‘æ§ â†’ å‘Šè­¦æ£€æŸ¥
    â†“
ç®¡ç†æ“ä½œ â†’ Adminç•Œé¢ â†’ Bootç®¡ç†API â†’ é…ç½®æ›´æ–° â†’ çŠ¶æ€åŒæ­¥
```

### ğŸ”— æ ¸å¿ƒç»„ä»¶å…³ç³»

1. **ljwx-boot (LicenseæœåŠ¡æ ¸å¿ƒ)**
   - `LicenseManager`: æ ¸å¿ƒLicenseç®¡ç†å™¨
   - `CustomerLicenseService`: å®¢æˆ·Licenseé›†æˆæœåŠ¡
   - `LicenseManagementService`: Licenseç®¡ç†ä¸šåŠ¡æœåŠ¡
   - `LicenseManagementController`: Licenseç®¡ç†APIæ§åˆ¶å™¨

2. **ljwx-bigscreen (è®¾å¤‡æ¥å…¥æ§åˆ¶)**
   - `BigScreenLicenseManager`: BigScreen Licenseç®¡ç†å™¨
   - `license_required`: LicenseéªŒè¯è£…é¥°å™¨
   - APIé›†æˆ: è®¾å¤‡æ•°é‡å’Œå¹¶å‘é™åˆ¶

3. **ljwx-admin (ç®¡ç†ç•Œé¢)**
   - ç³»ç»Ÿçº§Licenseç®¡ç†: `/system/license/`
   - ç§Ÿæˆ·çº§Licenseç®¡ç†: `/tenant/license/`
   - License APIæœåŠ¡: `/service/api/system/license.ts`

## æ ¸å¿ƒåŠŸèƒ½

### ğŸ” LicenseéªŒè¯æœºåˆ¶

#### 1. å¤šå±‚éªŒè¯æ¶æ„

```python
# éªŒè¯æµç¨‹
def license_validation_flow(device_sn, customer_id):
    # ç¬¬ä¸€å±‚ï¼šç³»ç»Ÿçº§Licenseæ£€æŸ¥
    if not system_license_valid():
        return False, "ç³»ç»ŸLicenseæ— æ•ˆ"
    
    # ç¬¬äºŒå±‚ï¼šç§Ÿæˆ·Licenseé…ç½®æ£€æŸ¥
    if not customer_license_enabled(customer_id):
        return False, "ç§Ÿæˆ·Licenseæœªå¯ç”¨"
    
    # ç¬¬ä¸‰å±‚ï¼šè®¾å¤‡æ•°é‡é™åˆ¶æ£€æŸ¥
    if not check_device_limit(device_sn, customer_id):
        return False, "è®¾å¤‡æ•°é‡è¶…å‡ºé™åˆ¶"
    
    # ç¬¬å››å±‚ï¼šå¹¶å‘é™åˆ¶æ£€æŸ¥
    if not check_concurrent_limit(customer_id):
        return False, "å¹¶å‘è¯·æ±‚è¶…å‡ºé™åˆ¶"
    
    return True, "éªŒè¯é€šè¿‡"
```

#### 2. è®¾å¤‡æ¥å…¥æ§åˆ¶

- **è®¾å¤‡æ³¨å†Œ**: è‡ªåŠ¨æ³¨å†Œæ–°è®¾å¤‡ï¼Œæ£€æŸ¥æ•°é‡é™åˆ¶
- **æ´»è·ƒç›‘æ§**: å®æ—¶ç›‘æ§è®¾å¤‡æ´»è·ƒçŠ¶æ€ï¼Œè‡ªåŠ¨æ¸…ç†ç¦»çº¿è®¾å¤‡
- **ä¸€è‡´æ€§ä¿è¯**: åŸºäºè®¾å¤‡SNçš„ä¸€è‡´æ€§å“ˆå¸Œï¼Œç¡®ä¿åŒä¸€è®¾å¤‡å§‹ç»ˆèµ°ç›¸åŒè·¯å¾„

#### 3. å¹¶å‘æ§åˆ¶æœºåˆ¶

- **å®æ—¶è®¡æ•°**: åŸºäºRedisçš„å®æ—¶å¹¶å‘è¯·æ±‚è®¡æ•°
- **è‡ªåŠ¨é‡Šæ”¾**: è¯·æ±‚å®Œæˆåè‡ªåŠ¨é‡Šæ”¾å¹¶å‘è®¡æ•°
- **ç§Ÿæˆ·éš”ç¦»**: æŒ‰ç§Ÿæˆ·åˆ†åˆ«ç»Ÿè®¡å¹¶å‘æ•°é‡

### ğŸ“Š ç›‘æ§å’Œç»Ÿè®¡

#### 1. å®æ—¶ç›‘æ§æŒ‡æ ‡

- Licenseæœ‰æ•ˆæ€§çŠ¶æ€
- è®¾å¤‡ä½¿ç”¨æƒ…å†µï¼ˆå½“å‰/æœ€å¤§ï¼‰
- å¹¶å‘è¯·æ±‚æ•°é‡ï¼ˆå½“å‰/æœ€å¤§ï¼‰
- ç§Ÿæˆ·å¯ç”¨ç»Ÿè®¡
- åŠŸèƒ½ä½¿ç”¨ç»Ÿè®¡

#### 2. å‘Šè­¦æœºåˆ¶

- Licenseå³å°†è¿‡æœŸå‘Šè­¦ï¼ˆ30å¤©ã€7å¤©ï¼‰
- è®¾å¤‡ä½¿ç”¨ç‡è¶…é™å‘Šè­¦ï¼ˆ90%ï¼‰
- å¹¶å‘è¯·æ±‚è¶…é™å‘Šè­¦
- ç³»ç»Ÿå¼‚å¸¸å‘Šè­¦

#### 3. å†å²æ•°æ®è·Ÿè¸ª

- Licenseæ“ä½œå†å²
- è®¾å¤‡è¿æ¥å†å²
- ä½¿ç”¨è¶‹åŠ¿åˆ†æ
- å¼‚å¸¸äº‹ä»¶è®°å½•

### ğŸ‘¥ å¤šç§Ÿæˆ·ç®¡ç†

#### 1. ç§Ÿæˆ·çº§åˆ«æ§åˆ¶

- ç‹¬ç«‹çš„Licenseå¯ç”¨/ç¦ç”¨é…ç½®
- ç§Ÿæˆ·çº§åˆ«çš„ä½¿ç”¨ç»Ÿè®¡
- ç§Ÿæˆ·ç®¡ç†å‘˜è‡ªåŠ©Licenseå¯¼å…¥
- ç§Ÿæˆ·çº§åˆ«çš„ç›‘æ§å‘Šè­¦

#### 2. æƒé™åˆ†çº§

- **è¶…çº§ç®¡ç†å‘˜**: å…¨å±€Licenseç®¡ç†ã€æ‰€æœ‰ç§Ÿæˆ·ç®¡ç†
- **ç§Ÿæˆ·ç®¡ç†å‘˜**: ä»…è‡ªå·±ç§Ÿæˆ·çš„LicenseæŸ¥çœ‹å’Œå¯¼å…¥
- **æ™®é€šç”¨æˆ·**: LicenseçŠ¶æ€æŸ¥çœ‹

## éƒ¨ç½²æŒ‡å—

### ğŸš€ ç¯å¢ƒè¦æ±‚

- **Java**: JDK 17+
- **Python**: Python 3.8+
- **æ•°æ®åº“**: MySQL 8.0+
- **ç¼“å­˜**: Redis 6.0+
- **å‰ç«¯**: Node.js 16+

### ğŸ“¦ éƒ¨ç½²æ­¥éª¤

#### 1. ljwx-boot éƒ¨ç½²

```bash
# 1. æ·»åŠ Licenseç›¸å…³ä¾èµ–ï¼ˆå·²åŒ…å«åœ¨ç°æœ‰é¡¹ç›®ä¸­ï¼‰
# 2. é…ç½®æ•°æ®åº“è¿æ¥
spring.datasource.url=jdbc:mysql://localhost:3306/ljwx_db
spring.datasource.username=root
spring.datasource.password=your_password

# 3. é…ç½®Redisè¿æ¥
spring.redis.host=localhost
spring.redis.port=6379
spring.redis.password=your_redis_password

# 4. Licenseé…ç½®
ljwx.license.file-path=./license/ljwx.lic
ljwx.license.check-interval=300

# 5. å¯åŠ¨æœåŠ¡
cd ljwx-boot
./run-local.sh start
```

#### 2. ljwx-bigscreen éƒ¨ç½²

```bash
# 1. ç¡®ä¿ä¾èµ–å·²å®‰è£…
cd ljwx-bigscreen/bigscreen/bigScreen
pip install requests

# 2. é…ç½®Boot APIåœ°å€
# åœ¨ license_manager.py ä¸­é…ç½®
boot_api_base_url = "http://localhost:8080/api"

# 3. å¯åŠ¨BigScreenæœåŠ¡
python run_bigscreen.py
```

#### 3. ljwx-admin éƒ¨ç½²

```bash
# 1. å®‰è£…ä¾èµ–
cd ljwx-admin
npm install

# 2. é…ç½®APIåœ°å€
# åœ¨ .env ä¸­é…ç½®
VITE_API_BASE_URL=http://localhost:8080

# 3. å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm run dev

# 4. ç”Ÿäº§æ„å»º
npm run build
```

### ğŸ”§ é…ç½®è¯´æ˜

#### 1. Licenseæ–‡ä»¶é…ç½®

```yaml
# ljwx.lic ç¤ºä¾‹ç»“æ„
licenseId: "LIC-20241201-001"
customerName: "ç¤ºä¾‹å®¢æˆ·"
licenseType: "enterprise"
maxDevices: 100
maxUsers: 500
features:
  - "bigscreen_access"
  - "user_management"
  - "device_monitoring"
  - "health_analytics"
startDate: "2024-01-01T00:00:00"
endDate: "2025-01-01T00:00:00"
```

#### 2. æ•°æ®åº“åˆå§‹åŒ–

```sql
-- ç§Ÿæˆ·é…ç½®è¡¨
ALTER TABLE t_customer_config 
ADD COLUMN is_support_license TINYINT(1) DEFAULT 0 COMMENT 'æ˜¯å¦æ”¯æŒLicenseåŠŸèƒ½';

-- Licenseä½¿ç”¨è®°å½•è¡¨ï¼ˆå¯é€‰ï¼‰
CREATE TABLE t_license_usage_log (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    customer_id BIGINT,
    operation VARCHAR(50),
    description TEXT,
    user_id BIGINT,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP
);
```

#### 3. Redisé…ç½®

```redis
# Redisé…ç½®å»ºè®®
maxmemory 2gb
maxmemory-policy allkeys-lru

# Licenseç›¸å…³é”®å€¼è®¾ç½®
set ljwx:license:global:enabled true
```

## ä½¿ç”¨è¯´æ˜

### ğŸ‘‘ è¶…çº§ç®¡ç†å‘˜æ“ä½œ

#### 1. Licenseå¯¼å…¥

1. ç™»å½•ljwx-adminç®¡ç†ç•Œé¢
2. å¯¼èˆªåˆ° `ç³»ç»Ÿç®¡ç† > Licenseç®¡ç†`
3. ç‚¹å‡» `å¯¼å…¥License` æŒ‰é’®
4. é€‰æ‹©.licæ ¼å¼çš„Licenseæ–‡ä»¶
5. ç¡®è®¤å¯¼å…¥ï¼Œç³»ç»Ÿè‡ªåŠ¨éªŒè¯å¹¶ç”Ÿæ•ˆ

#### 2. å…¨å±€Licenseæ§åˆ¶

```javascript
// å…¨å±€å¯ç”¨LicenseåŠŸèƒ½
PUT /api/license/management/toggle/true

// å…¨å±€ç¦ç”¨LicenseåŠŸèƒ½
PUT /api/license/management/toggle/false
```

#### 3. ç§Ÿæˆ·Licenseç®¡ç†

1. åœ¨ç§Ÿæˆ·åˆ—è¡¨ä¸­é€‰æ‹©ç›®æ ‡ç§Ÿæˆ·
2. ç‚¹å‡» `å¯ç”¨/ç¦ç”¨` æŒ‰é’®åˆ‡æ¢ç§Ÿæˆ·LicenseçŠ¶æ€
3. ç‚¹å‡» `æŸ¥çœ‹çŠ¶æ€` æŸ¥çœ‹è¯¦ç»†Licenseä¿¡æ¯

#### 4. ç›‘æ§å’Œç»Ÿè®¡

- **å®æ—¶çŠ¶æ€**: æŸ¥çœ‹Licenseæœ‰æ•ˆæ€§ã€è®¾å¤‡ä½¿ç”¨æƒ…å†µã€å¹¶å‘çŠ¶æ€
- **ä½¿ç”¨ç»Ÿè®¡**: æŸ¥çœ‹å†å²ä½¿ç”¨è¶‹åŠ¿ã€åŠŸèƒ½ä½¿ç”¨ç»Ÿè®¡
- **å‘Šè­¦ç®¡ç†**: ç›‘æ§Licenseè¿‡æœŸã€ä½¿ç”¨ç‡å‘Šè­¦

### ğŸ¢ ç§Ÿæˆ·ç®¡ç†å‘˜æ“ä½œ

#### 1. æŸ¥çœ‹LicenseçŠ¶æ€

1. ç™»å½•ljwx-adminç®¡ç†ç•Œé¢
2. å¯¼èˆªåˆ° `æˆ‘çš„License`
3. æŸ¥çœ‹Licenseè¯¦ç»†ä¿¡æ¯ã€ä½¿ç”¨æƒ…å†µã€å‰©ä½™æ—¶é—´

#### 2. å¯¼å…¥License

1. åœ¨ `æˆ‘çš„License` é¡µé¢ç‚¹å‡» `å¯¼å…¥License`
2. ä¸Šä¼ æ–°çš„Licenseæ–‡ä»¶
3. ç³»ç»Ÿè‡ªåŠ¨éªŒè¯å¹¶æ›´æ–°é…ç½®

#### 3. ç›‘æ§è®¾å¤‡ä½¿ç”¨

- æŸ¥çœ‹å½“å‰åœ¨çº¿è®¾å¤‡åˆ—è¡¨
- ç›‘æ§è®¾å¤‡ä½¿ç”¨ç‡å’Œè¶‹åŠ¿
- æ¥æ”¶ä½¿ç”¨ç‡å‘Šè­¦

### ğŸ–¥ï¸ BigScreenè®¾å¤‡æ¥å…¥

#### 1. è‡ªåŠ¨LicenseéªŒè¯

```python
# è®¾å¤‡æ•°æ®ä¸Šä¼ æ—¶è‡ªåŠ¨éªŒè¯
@app.route("/upload_health_data", methods=['POST'])
def handle_health_data():
    # LicenseéªŒè¯å·²é›†æˆåˆ°æ•°æ®ä¸Šä¼ æµç¨‹
    # è‡ªåŠ¨æ£€æŸ¥è®¾å¤‡æ•°é‡å’Œå¹¶å‘é™åˆ¶
    pass
```

#### 2. LicenseçŠ¶æ€æŸ¥è¯¢

```bash
# æŸ¥è¯¢BigScreen LicenseçŠ¶æ€
curl http://localhost:5225/api/license/status

# æŸ¥è¯¢Licenseä»ªè¡¨æ¿æ•°æ®
curl http://localhost:5225/api/license/dashboard
```

#### 3. è®¾å¤‡æƒé™æ£€æŸ¥

```python
# æ£€æŸ¥ç‰¹å®šè®¾å¤‡çš„Licenseæƒé™
from bigScreen.license_manager import check_device_license

result = check_device_license("DEVICE_001", customer_id=1)
if result['allowed']:
    print("è®¾å¤‡æ¥å…¥æƒé™æ­£å¸¸")
else:
    print(f"è®¾å¤‡æ¥å…¥è¢«æ‹’ç»: {result['reason']}")
```

## APIæ–‡æ¡£

### ğŸ”Œ ljwx-boot License API

#### 1. ç³»ç»Ÿçº§Licenseç®¡ç†

```http
# è·å–LicenseçŠ¶æ€
GET /api/license/management/status
Response: {
    "success": true,
    "data": {
        "licenseEnabled": true,
        "licenseValid": true,
        "globalEnabled": true,
        "licenseInfo": {...},
        "remainingDays": 365
    }
}

# å¯¼å…¥License
POST /api/license/management/import
Content-Type: multipart/form-data
Body: file=@license.lic

# å…¨å±€å¯ç”¨/ç¦ç”¨License
POST /api/license/management/toggle/{enabled}
```

#### 2. ç§Ÿæˆ·Licenseç®¡ç†

```http
# è·å–ç§Ÿæˆ·Licenseåˆ—è¡¨
GET /api/license/management/tenant/list?pageNum=1&pageSize=10

# ç§Ÿæˆ·Licenseå¯ç”¨/ç¦ç”¨
POST /api/license/management/tenant/{customerId}/toggle/{enabled}

# è·å–ç§Ÿæˆ·LicenseçŠ¶æ€
GET /api/license/management/tenant/{customerId}/status
```

#### 3. Licenseç»Ÿè®¡å’Œç›‘æ§

```http
# è·å–Licenseä½¿ç”¨ç»Ÿè®¡
GET /api/license/management/statistics

# è·å–Licenseä½¿ç”¨å†å²
GET /api/license/management/usage/history

# é‡æ–°éªŒè¯License
POST /api/license/management/revalidate
```

### ğŸ–¥ï¸ ljwx-bigscreen License API

#### 1. LicenseçŠ¶æ€æŸ¥è¯¢

```http
# è·å–LicenseçŠ¶æ€
GET /api/license/status
Response: {
    "success": true,
    "data": {
        "license_valid": true,
        "device_limits": {
            "max_devices": 100,
            "current_devices": 15,
            "active_devices": ["DEV001", "DEV002"]
        },
        "concurrent_limits": {
            "max_concurrent": 500,
            "current_concurrent": 23
        }
    }
}

# è·å–Licenseä»ªè¡¨æ¿æ•°æ®
GET /api/license/dashboard

# æ£€æŸ¥è®¾å¤‡Licenseæƒé™
POST /api/license/device/check
Body: {
    "device_sn": "DEVICE_001",
    "customer_id": 1
}
```

### ğŸ¨ ljwx-admin License API

#### 1. TypeScriptç±»å‹å®šä¹‰

```typescript
// Licenseä¿¡æ¯ç±»å‹
interface LicenseInfo {
    licenseId: string
    customerName: string
    licenseType: string
    maxDevices: number
    maxUsers: number
    features: string[]
    startDate: string
    endDate: string
}

// ç§Ÿæˆ·LicenseçŠ¶æ€ç±»å‹
interface TenantLicenseStatus {
    customerId: number
    effectiveLicenseEnabled: boolean
    licenseInfo?: LicenseInfo
    remainingDays?: number
}
```

#### 2. APIæœåŠ¡è°ƒç”¨

```typescript
import { getLicenseStatus, importLicense } from '@/service/api/system/license'

// è·å–LicenseçŠ¶æ€
const status = await getLicenseStatus()

// å¯¼å…¥Licenseæ–‡ä»¶
const result = await importLicense(file)
```

## æ•…éšœæ’é™¤

### ğŸš¨ å¸¸è§é—®é¢˜

#### 1. LicenseéªŒè¯å¤±è´¥

**ç—‡çŠ¶**: BigScreenè®¾å¤‡æ— æ³•æ¥å…¥ï¼Œè¿”å›LicenseéªŒè¯å¤±è´¥
**åŸå› **: 
- Licenseæ–‡ä»¶æ— æ•ˆæˆ–å·²è¿‡æœŸ
- BootæœåŠ¡æ— æ³•è¿æ¥
- LicenseåŠŸèƒ½è¢«å…¨å±€ç¦ç”¨

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥Licenseæ–‡ä»¶æœ‰æ•ˆæ€§
curl http://localhost:8080/api/license/management/status

# 2. æ£€æŸ¥BootæœåŠ¡è¿æ¥
curl http://localhost:8080/health

# 3. æ£€æŸ¥Licenseå…¨å±€çŠ¶æ€
curl http://localhost:8080/api/license/management/status | grep globalEnabled

# 4. é‡æ–°éªŒè¯License
curl -X POST http://localhost:8080/api/license/management/revalidate
```

#### 2. è®¾å¤‡æ•°é‡è¶…é™

**ç—‡çŠ¶**: æ–°è®¾å¤‡æ— æ³•æ¥å…¥ï¼Œæç¤ºè®¾å¤‡æ•°é‡è¶…å‡ºé™åˆ¶
**åŸå› **:
- è¾¾åˆ°Licenseè®¾å¤‡æ•°é‡ä¸Šé™
- ç¦»çº¿è®¾å¤‡æœªåŠæ—¶æ¸…ç†

**è§£å†³æ–¹æ¡ˆ**:
```python
# 1. æ£€æŸ¥å½“å‰è®¾å¤‡ä½¿ç”¨æƒ…å†µ
from bigScreen.license_manager import get_license_manager
manager = get_license_manager()
status = manager.get_license_status()
print(f"è®¾å¤‡ä½¿ç”¨æƒ…å†µ: {status['device_limits']}")

# 2. æ‰‹åŠ¨æ¸…ç†ç¦»çº¿è®¾å¤‡
manager.cleanup_expired_devices()

# 3. æ£€æŸ¥Licenseè®¾å¤‡é™åˆ¶
print(f"è®¾å¤‡é™åˆ¶: {manager.get_device_limits()}")
```

#### 3. å¹¶å‘è¯·æ±‚è¶…é™

**ç—‡çŠ¶**: å¥åº·æ•°æ®ä¸Šä¼ å¤±è´¥ï¼Œæç¤ºå¹¶å‘è¶…é™
**åŸå› **:
- ç¬æ—¶å¹¶å‘è¯·æ±‚è¿‡å¤š
- å¹¶å‘è®¡æ•°æœªæ­£ç¡®é‡Šæ”¾

**è§£å†³æ–¹æ¡ˆ**:
```python
# 1. æ£€æŸ¥å½“å‰å¹¶å‘æƒ…å†µ
status = manager.get_license_status()
print(f"å¹¶å‘æƒ…å†µ: {status['concurrent_limits']}")

# 2. é‡ç½®å¹¶å‘è®¡æ•°ï¼ˆç´§æ€¥æƒ…å†µï¼‰
with manager.request_counter_lock:
    manager.concurrent_requests.clear()

# 3. è°ƒæ•´å¹¶å‘é™åˆ¶ï¼ˆä¸´æ—¶ï¼‰
max_devices, max_concurrent = manager.get_device_limits()
# å¯ä»¥åœ¨ä»£ç ä¸­ä¸´æ—¶è°ƒæ•´é™åˆ¶
```

#### 4. å‰ç«¯ç•Œé¢å¼‚å¸¸

**ç—‡çŠ¶**: Licenseç®¡ç†ç•Œé¢åŠ è½½å¤±è´¥æˆ–æ˜¾ç¤ºå¼‚å¸¸
**åŸå› **:
- APIæ¥å£è¿æ¥å¤±è´¥
- æƒé™ä¸è¶³
- æ•°æ®æ ¼å¼å¼‚å¸¸

**è§£å†³æ–¹æ¡ˆ**:
```bash
# 1. æ£€æŸ¥APIè¿æ¥
curl http://localhost:8080/api/license/management/status

# 2. æ£€æŸ¥ç”¨æˆ·æƒé™
# ç¡®ä¿ç”¨æˆ·å…·æœ‰ç›¸åº”çš„Licenseç®¡ç†æƒé™

# 3. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯
# æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹é”™è¯¯ä¿¡æ¯

# 4. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
# æ¸…é™¤ç¼“å­˜åé‡æ–°åŠ è½½é¡µé¢
```

### ğŸ” æ—¥å¿—åˆ†æ

#### 1. ljwx-boot æ—¥å¿—

```bash
# Licenseç›¸å…³æ—¥å¿—ä½ç½®
tail -f ljwx-boot/logs/license.log

# å…³é”®æ—¥å¿—ç¤ºä¾‹
2024-01-01 10:00:00 [INFO] LicenseéªŒè¯é€šè¿‡, å®¢æˆ·: å®¢æˆ·A
2024-01-01 10:00:01 [WARN] è®¾å¤‡æ•°é‡æ¥è¿‘é™åˆ¶, å½“å‰: 95, æœ€å¤§: 100
2024-01-01 10:00:02 [ERROR] LicenseéªŒè¯å¤±è´¥: Licenseå·²è¿‡æœŸ
```

#### 2. ljwx-bigscreen æ—¥å¿—

```bash
# BigScreen Licenseæ—¥å¿—
tail -f ljwx-bigscreen/bigscreen/logs/bigscreen.log | grep License

# å…³é”®æ—¥å¿—ç¤ºä¾‹
2024-01-01 10:00:00 [INFO] âœ… LicenseéªŒè¯é€šè¿‡: DEVICE_001
2024-01-01 10:00:01 [WARN] âŒ LicenseéªŒè¯å¤±è´¥: è®¾å¤‡æ•°é‡è¶…å‡ºé™åˆ¶
2024-01-01 10:00:02 [INFO] ğŸ” Licenseç®¡ç†å™¨åˆå§‹åŒ–å®Œæˆ
```

### ğŸ“Š ç›‘æ§å‘Šè­¦é…ç½®

#### 1. è®¾ç½®ç›‘æ§è„šæœ¬

```bash
#!/bin/bash
# license_monitor.sh
# LicenseçŠ¶æ€ç›‘æ§è„šæœ¬

API_BASE="http://localhost:8080/api"
WEBHOOK_URL="your_alert_webhook_url"

# æ£€æŸ¥LicenseçŠ¶æ€
status=$(curl -s "$API_BASE/license/management/status")
license_valid=$(echo $status | jq -r '.data.licenseValid')
remaining_days=$(echo $status | jq -r '.data.remainingDays')

# Licenseè¿‡æœŸå‘Šè­¦
if [ "$remaining_days" -lt 7 ]; then
    curl -X POST $WEBHOOK_URL -d "{\"text\": \"Licenseå³å°†è¿‡æœŸï¼Œå‰©ä½™${remaining_days}å¤©\"}"
fi

# è®¾å¤‡ä½¿ç”¨ç‡å‘Šè­¦
device_stats=$(curl -s "$API_BASE/license/management/statistics")
usage_rate=$(echo $device_stats | jq -r '.data.deviceUsageRate')

if [ "$usage_rate" -gt 90 ]; then
    curl -X POST $WEBHOOK_URL -d "{\"text\": \"è®¾å¤‡ä½¿ç”¨ç‡è¿‡é«˜ï¼š${usage_rate}%\"}"
fi
```

#### 2. å®šæ—¶ä»»åŠ¡é…ç½®

```bash
# æ·»åŠ åˆ°crontab
crontab -e

# æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡LicenseçŠ¶æ€
0 * * * * /path/to/license_monitor.sh

# æ¯å¤©æ£€æŸ¥ä¸€æ¬¡è¿‡æœŸæƒ…å†µ
0 9 * * * /path/to/license_expiry_check.sh
```

## æœ€ä½³å®è·µ

### ğŸ¯ Licenseç®¡ç†æœ€ä½³å®è·µ

#### 1. Licenseæ–‡ä»¶ç®¡ç†

- **ç‰ˆæœ¬æ§åˆ¶**: ä¸ºLicenseæ–‡ä»¶å»ºç«‹ç‰ˆæœ¬æ§åˆ¶ï¼Œè®°å½•æ¯æ¬¡æ›´æ–°
- **å¤‡ä»½ç­–ç•¥**: å®šæœŸå¤‡ä»½Licenseæ–‡ä»¶å’Œé…ç½®ï¼Œç¡®ä¿å¿«é€Ÿæ¢å¤
- **æƒé™æ§åˆ¶**: ä¸¥æ ¼æ§åˆ¶Licenseæ–‡ä»¶çš„è®¿é—®æƒé™
- **æ›´æ–°æµç¨‹**: å»ºç«‹æ ‡å‡†çš„Licenseæ›´æ–°æµç¨‹å’Œå®¡æ‰¹æœºåˆ¶

#### 2. ç›‘æ§å’Œå‘Šè­¦

- **æå‰å‘Šè­¦**: è®¾ç½®30å¤©ã€7å¤©çš„è¿‡æœŸæé†’
- **ä½¿ç”¨ç‡ç›‘æ§**: å½“è®¾å¤‡ä½¿ç”¨ç‡è¶…è¿‡80%æ—¶å‘å‡ºè­¦å‘Š
- **å¼‚å¸¸æ£€æµ‹**: ç›‘æ§LicenseéªŒè¯å¤±è´¥ç‡ï¼ŒåŠæ—¶å‘ç°é—®é¢˜
- **å®šæœŸæ£€æŸ¥**: å»ºç«‹å®šæœŸçš„LicenseçŠ¶æ€æ£€æŸ¥æœºåˆ¶

#### 3. ç§Ÿæˆ·ç®¡ç†

- **åˆ†çº§ç®¡ç†**: å»ºç«‹æ¸…æ™°çš„æƒé™åˆ†çº§ï¼Œé¿å…æƒé™æ··ä¹±
- **è‡ªåŠ©æœåŠ¡**: ä¸ºç§Ÿæˆ·ç®¡ç†å‘˜æä¾›è‡ªåŠ©Licenseå¯¼å…¥åŠŸèƒ½
- **ä½¿ç”¨ç»Ÿè®¡**: å®šæœŸå‘ç§Ÿæˆ·æä¾›Licenseä½¿ç”¨æŠ¥å‘Š
- **å®¹é‡è§„åˆ’**: æ ¹æ®ä½¿ç”¨è¶‹åŠ¿è¿›è¡ŒLicenseå®¹é‡è§„åˆ’

#### 4. æ€§èƒ½ä¼˜åŒ–

- **ç¼“å­˜ç­–ç•¥**: åˆç†ä½¿ç”¨Redisç¼“å­˜ï¼Œå‡å°‘æ•°æ®åº“å‹åŠ›
- **æ‰¹é‡å¤„ç†**: å¯¹å¤§é‡è®¾å¤‡çš„Licenseæ£€æŸ¥ä½¿ç”¨æ‰¹é‡å¤„ç†
- **å¼‚æ­¥å¤„ç†**: éå…³é”®Licenseæ“ä½œä½¿ç”¨å¼‚æ­¥å¤„ç†
- **è¿æ¥æ± **: é…ç½®åˆé€‚çš„æ•°æ®åº“è¿æ¥æ± å¤§å°

### ğŸ”’ å®‰å…¨å»ºè®®

#### 1. Licenseæ–‡ä»¶å®‰å…¨

```bash
# è®¾ç½®Licenseæ–‡ä»¶æƒé™
chmod 600 ./license/ljwx.lic
chown ljwx:ljwx ./license/ljwx.lic

# åŠ å¯†å­˜å‚¨æ•æ„Ÿä¿¡æ¯
# ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨Licenseå¯†é’¥
export LICENSE_KEY="your_secret_key"
```

#### 2. APIå®‰å…¨

- **è®¤è¯æˆæƒ**: æ‰€æœ‰Licenseç®¡ç†APIéƒ½éœ€è¦é€‚å½“çš„è®¤è¯æˆæƒ
- **è®¿é—®æ§åˆ¶**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ï¼Œé™åˆ¶æ•æ„Ÿæ“ä½œæƒé™
- **å®¡è®¡æ—¥å¿—**: è®°å½•æ‰€æœ‰Licenseç›¸å…³æ“ä½œçš„å®¡è®¡æ—¥å¿—
- **åŠ å¯†ä¼ è¾“**: ä½¿ç”¨HTTPSåŠ å¯†æ‰€æœ‰APIé€šä¿¡

#### 3. æ•°æ®ä¿æŠ¤

- **æ•°æ®åŠ å¯†**: æ•æ„ŸLicenseä¿¡æ¯è¿›è¡ŒåŠ å¯†å­˜å‚¨
- **å¤‡ä»½åŠ å¯†**: Licenseå¤‡ä»½æ–‡ä»¶è¿›è¡ŒåŠ å¯†ä¿æŠ¤
- **è®¿é—®æ—¥å¿—**: è®°å½•æ‰€æœ‰Licenseæ•°æ®è®¿é—®æ—¥å¿—
- **å®šæœŸæ¸…ç†**: å®šæœŸæ¸…ç†è¿‡æœŸçš„Licenseä½¿ç”¨è®°å½•

### ğŸ“ˆ æ‰©å±•æ€§è€ƒè™‘

#### 1. æ°´å¹³æ‰©å±•

- **æ— çŠ¶æ€è®¾è®¡**: LicenseéªŒè¯é€»è¾‘è®¾è®¡ä¸ºæ— çŠ¶æ€ï¼Œæ”¯æŒå¤šå®ä¾‹éƒ¨ç½²
- **ç¼“å­˜å…±äº«**: ä½¿ç”¨Redisé›†ç¾¤å®ç°å¤šå®ä¾‹é—´çš„ç¼“å­˜å…±äº«
- **è´Ÿè½½å‡è¡¡**: é…ç½®é€‚å½“çš„è´Ÿè½½å‡è¡¡ç­–ç•¥

#### 2. åŠŸèƒ½æ‰©å±•

- **æ’ä»¶æœºåˆ¶**: è®¾è®¡LicenseåŠŸèƒ½çš„æ’ä»¶æœºåˆ¶ï¼Œæ”¯æŒå®šåˆ¶åŒ–éœ€æ±‚
- **å¤šçº§License**: æ”¯æŒä¼ä¸šç‰ˆã€ä¸“ä¸šç‰ˆã€æ ‡å‡†ç‰ˆç­‰å¤šçº§License
- **åŠ¨æ€åŠŸèƒ½**: æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€å¯ç”¨/ç¦ç”¨åŠŸèƒ½æ¨¡å—

#### 3. é›†æˆæ‰©å±•

- **ç¬¬ä¸‰æ–¹é›†æˆ**: æ”¯æŒä¸å¤–éƒ¨LicenseæœåŠ¡çš„é›†æˆ
- **APIå¼€æ”¾**: æä¾›å¼€æ”¾APIä¾›ç¬¬ä¸‰æ–¹ç³»ç»Ÿé›†æˆ
- **æ ‡å‡†åè®®**: éµå¾ªè¡Œä¸šæ ‡å‡†çš„Licenseç®¡ç†åè®®

### ğŸ“‹ è¿ç»´æ£€æŸ¥æ¸…å•

#### æ—¥å¸¸æ£€æŸ¥

- [ ] Licenseæœ‰æ•ˆæ€§çŠ¶æ€
- [ ] è®¾å¤‡ä½¿ç”¨ç‡ï¼ˆå»ºè®®<80%ï¼‰
- [ ] å¹¶å‘è¯·æ±‚çŠ¶å†µ
- [ ] ç³»ç»Ÿå‘Šè­¦ä¿¡æ¯
- [ ] APIå“åº”æ—¶é—´

#### æ¯å‘¨æ£€æŸ¥

- [ ] Licenseå‰©ä½™æ—¶é—´
- [ ] ç§Ÿæˆ·Licenseé…ç½®
- [ ] ä½¿ç”¨è¶‹åŠ¿åˆ†æ
- [ ] å¼‚å¸¸äº‹ä»¶å›é¡¾
- [ ] æ€§èƒ½æŒ‡æ ‡è¯„ä¼°

#### æ¯æœˆæ£€æŸ¥

- [ ] Licenseä½¿ç”¨æŠ¥å‘Š
- [ ] å®¹é‡è§„åˆ’è¯„ä¼°
- [ ] å®‰å…¨æ¼æ´æ£€æŸ¥
- [ ] å¤‡ä»½æ¢å¤æµ‹è¯•
- [ ] æµç¨‹ä¼˜åŒ–å»ºè®®

## è”ç³»æ”¯æŒ

å¦‚æœåœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **é”™è¯¯ä¿¡æ¯**: å®Œæ•´çš„é”™è¯¯æ—¥å¿—å’Œå †æ ˆä¿¡æ¯
2. **ç³»ç»Ÿç¯å¢ƒ**: æ“ä½œç³»ç»Ÿã€Javaç‰ˆæœ¬ã€Pythonç‰ˆæœ¬ç­‰
3. **Licenseä¿¡æ¯**: Licenseç±»å‹ã€è¿‡æœŸæ—¶é—´ã€åŠŸèƒ½åˆ—è¡¨
4. **æ“ä½œæ­¥éª¤**: è¯¦ç»†çš„é—®é¢˜å¤ç°æ­¥éª¤
5. **ç›¸å…³é…ç½®**: ç›¸å…³çš„é…ç½®æ–‡ä»¶å’Œå‚æ•°è®¾ç½®

---

**ç‰ˆæœ¬**: v1.0.0  
**æ›´æ–°æ—¶é—´**: 2024å¹´12æœˆ  
**æ–‡æ¡£ç»´æŠ¤**: LJWXæŠ€æœ¯å›¢é˜Ÿ

> ğŸ’¡ **æç¤º**: æœ¬æ–‡æ¡£ä¼šéšç€ç³»ç»Ÿæ›´æ–°æŒç»­å®Œå–„ï¼Œå»ºè®®å®šæœŸæŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ã€‚