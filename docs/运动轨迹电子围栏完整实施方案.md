# è¿åŠ¨è½¨è¿¹ & ç”µå­å›´æ ç³»ç»Ÿå®Œæ•´å®æ–½æ–¹æ¡ˆä¸è¿›åº¦è·Ÿè¸ª

## é¡¹ç›®æ¦‚è¿°

åŸºäºç°æœ‰çš„çµå¢ƒä¸‡è±¡ç³»ç»Ÿæ¶æ„ï¼Œå®æ–½ä¸€å¥—å®Œæ•´çš„ä¼ä¸šçº§è¿åŠ¨è½¨è¿¹ä¸ç”µå­å›´æ åŠŸèƒ½æ¨¡å—ï¼Œé¢å‘1000ç”¨æˆ·è§„æ¨¡ï¼Œæ•´åˆç°æœ‰çš„å¥åº·æ•°æ®åŸºç¡€è®¾æ–½ï¼Œæä¾›ä¸“ä¸šçš„ä½ç½®ç›‘æ§ã€è½¨è¿¹åˆ†æå’Œå›´æ ç®¡ç†è§£å†³æ–¹æ¡ˆã€‚

## ğŸš¨ å…³é”®æ¶æ„çº¦æŸ

### æ•°æ®è®¿é—®è§„èŒƒ (å¿…é¡»ä¸¥æ ¼éµå¾ª)
```
âŒ ç¦æ­¢æ“ä½œï¼šç›´æ¥æŸ¥è¯¢ t_user_health_data è¡¨
âœ… å¿…é¡»æ“ä½œï¼šé€šè¿‡ UnifiedHealthDataQueryService.queryHealthData() æ–¹æ³•æŸ¥è¯¢å¥åº·æ•°æ®

ç†ç”±ï¼š
1. UnifiedHealthDataQueryService å·²å®ç°é«˜æ€§èƒ½çš„æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–
2. æ”¯æŒåˆ†è¡¨è·¯ç”±å’Œè·¨æœˆæŸ¥è¯¢
3. å†…ç½®å¤šç§Ÿæˆ·æƒé™æ§åˆ¶å’Œæ•°æ®éš”ç¦»
4. æä¾›ç»Ÿä¸€çš„å­—æ®µé…ç½®å’Œç¼“å­˜æœºåˆ¶
5. ç»´æŠ¤æ•°æ®è®¿é—®çš„ä¸€è‡´æ€§å’Œå®‰å…¨æ€§
```

### ç°æœ‰ç³»ç»Ÿé›†æˆç‚¹
```
ç°æœ‰åŸºç¡€è®¾æ–½ï¼š
â”œâ”€â”€ t_user_health_data (åŒ…å« latitude, longitude, altitude, distance ç­‰è½¨è¿¹å­—æ®µ)
â”œâ”€â”€ UnifiedHealthDataQueryService (ç»Ÿä¸€æ•°æ®æŸ¥è¯¢æœåŠ¡ï¼Œå·²ä¼˜åŒ–æ€§èƒ½)
â”œâ”€â”€ TGeofenceServiceImpl (å›´æ åŸºç¡€ç®¡ç†æœåŠ¡)
â”œâ”€â”€ Sa-Token æƒé™ä½“ç³» (å¤šç§Ÿæˆ·æƒé™æ§åˆ¶)
â””â”€â”€ å‰ç«¯ç»„ä»¶ (TrackMapComponent, é«˜å¾·åœ°å›¾é›†æˆ)

æ‰©å±•æ–¹å¼ï¼š
â”œâ”€â”€ è½¨è¿¹åŠŸèƒ½ï¼šåŸºäº queryHealthData ç»“æœè¿›è¡Œè½¨è¿¹åˆ†æ
â”œâ”€â”€ å›´æ åŠŸèƒ½ï¼šæ‰©å±•ç°æœ‰ TGeofenceServiceImpl
â”œâ”€â”€ å®æ—¶æ¨é€ï¼šæ–°å¢ WebSocket æœåŠ¡
â””â”€â”€ å‰ç«¯å¢å¼ºï¼šåŸºäºç°æœ‰åœ°å›¾ç»„ä»¶æ‰©å±•
```

---

## ç¬¬ä¸€é˜¶æ®µï¼šé¡¹ç›®å‡†å¤‡ä¸åŸºç¡€è®¾æ–½ (2å‘¨)

### 1.1 é¡¹ç›®å¯åŠ¨å‡†å¤‡

#### é‡è¦æŠ€æœ¯çº¦æŸç¡®è®¤
- [ ] **æ•°æ®æŸ¥è¯¢è§„èŒƒ**ï¼šæ‰€æœ‰å¥åº·æ•°æ®æŸ¥è¯¢å¿…é¡»é€šè¿‡ `UnifiedHealthDataQueryService.queryHealthData` æ–¹æ³•
- [ ] **è¡¨ç»“æ„çº¦æŸ**ï¼šåŸºäºç°æœ‰ `t_user_health_data` è¡¨ï¼Œä¸å¯ç›´æ¥SQLæŸ¥è¯¢
- [ ] **æ€§èƒ½ä¼˜åŒ–å¤ç”¨**ï¼šå……åˆ†åˆ©ç”¨ç°æœ‰çš„æ‰¹é‡æŸ¥è¯¢ã€ç¼“å­˜ã€åˆ†è¡¨ç­‰ä¼˜åŒ–æœºåˆ¶
- [ ] **å¤šç§Ÿæˆ·å…¼å®¹**ï¼šç¡®ä¿æ–°åŠŸèƒ½ä¸ç°æœ‰å¤šç§Ÿæˆ·æ¶æ„å®Œå…¨å…¼å®¹

#### ä»»åŠ¡æ¸…å•
- [ ] **é¡¹ç›®å›¢é˜Ÿç»„å»º**
  - [ ] äº§å“ç»ç† x1 (è´Ÿè´£éœ€æ±‚ç®¡ç†ã€ç”¨æˆ·éªŒæ”¶)
  - [ ] æŠ€æœ¯æ¶æ„å¸ˆ x1 (è´Ÿè´£æŠ€æœ¯é€‰å‹ã€æ¶æ„è®¾è®¡)
  - [ ] åç«¯å¼€å‘å·¥ç¨‹å¸ˆ x2 (Spring Bootå¼€å‘)
  - [ ] å‰ç«¯å¼€å‘å·¥ç¨‹å¸ˆ x2 (Vue3 + åœ°å›¾ç»„ä»¶å¼€å‘)
  - [ ] æµ‹è¯•å·¥ç¨‹å¸ˆ x1 (åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•)
  - [ ] DevOpså·¥ç¨‹å¸ˆ x1 (éƒ¨ç½²è¿ç»´)

#### æ—¶é—´èŠ‚ç‚¹
- **ç¬¬1å¤©**: é¡¹ç›®å¯åŠ¨ä¼šè®®ï¼Œå›¢é˜Ÿè§’è‰²åˆ†å·¥
- **ç¬¬2-3å¤©**: ç°æœ‰ç³»ç»Ÿè°ƒç ”åˆ†æï¼ŒæŠ€æœ¯å€ºåŠ¡è¯„ä¼°
- **ç¬¬4-5å¤©**: è¯¦ç»†éœ€æ±‚ç¡®è®¤ï¼Œç”¨æˆ·æ•…äº‹ç¼–å†™

#### äº¤ä»˜ç‰©
- [ ] é¡¹ç›®ç« ç¨‹æ–‡æ¡£
- [ ] å›¢é˜ŸèŒè´£åˆ†å·¥è¡¨
- [ ] ç°æœ‰ç³»ç»ŸæŠ€æœ¯è¯„ä¼°æŠ¥å‘Š
- [ ] è¯¦ç»†éœ€æ±‚è§„æ ¼ä¹¦ (PRD 2.0ç‰ˆæœ¬)

### 1.2 æŠ€æœ¯åŸºç¡€è®¾æ–½å‡†å¤‡

#### ç°æœ‰ç³»ç»Ÿé›†æˆç‚¹åˆ†æ
```java
// ç°æœ‰ç³»ç»Ÿå¤ç”¨ç»„ä»¶
1. æ•°æ®å±‚å¤ç”¨:
   - t_user_health_data (ä½ç½®æ•°æ®å·²å­˜åœ¨)
   - t_geofence (å›´æ åŸºç¡€å®ç°å·²æœ‰)
   - ç”¨æˆ·æƒé™ä½“ç³» (Sa-Token)

2. æœåŠ¡å±‚æ‰©å±•:
   - UnifiedHealthDataQueryService (æ€§èƒ½ä¼˜åŒ–çš„æŸ¥è¯¢æœåŠ¡)
   - TGeofenceServiceImpl (å›´æ åŸºç¡€ç®¡ç†)
   
3. å‰ç«¯ç»„ä»¶å¤ç”¨:
   - TrackMapComponent (åŸºç¡€è½¨è¿¹ç»„ä»¶)
   - é«˜å¾·åœ°å›¾é›†æˆ (å·²æœ‰åœ°å›¾æœåŠ¡)
```

#### æŠ€æœ¯æ ˆå‡çº§è®¡åˆ’
- [ ] **æ•°æ®åº“æ‰©å±•**
  - [ ] MySQLç©ºé—´ç´¢å¼•ä¼˜åŒ– (SPATIAL INDEX)
  - [ ] Redisé›†ç¾¤éƒ¨ç½² (æ”¯æŒåœ°ç†ä½ç½®ç¼“å­˜)
  - [ ] è½¨è¿¹æ•°æ®åˆ†è¡¨ç­–ç•¥ (æŒ‰æœˆåˆ†è¡¨)

- [ ] **åç«¯æœåŠ¡å¢å¼º**
  - [ ] WebSocketå®æ—¶æ¨é€æœåŠ¡
  - [ ] å›´æ è®¡ç®—å¼•æ“ (JTS Topology Suite)
  - [ ] è½¨è¿¹æŠ½ç¨€ç®—æ³• (Douglas-Peucker)

- [ ] **å‰ç«¯æ¶æ„å‡çº§**
  - [ ] MapBox GLæ›¿æ¢æ–¹æ¡ˆè¯„ä¼° (vs é«˜å¾·åœ°å›¾)
  - [ ] å¤§æ•°æ®é‡æ¸²æŸ“ä¼˜åŒ– (Canvas + WebGL)
  - [ ] PWAæ”¯æŒ (ç¦»çº¿åŠŸèƒ½)

#### å¼€å‘ç¯å¢ƒå‡†å¤‡
- [ ] **CI/CDæµæ°´çº¿é…ç½®**
  - [ ] Gitåˆ†æ”¯ç­–ç•¥ (GitFlow)
  - [ ] è‡ªåŠ¨åŒ–æµ‹è¯•é›†æˆ
  - [ ] å®¹å™¨åŒ–éƒ¨ç½² (Docker + K8s)

- [ ] **ç›‘æ§ä½“ç³»æ­å»º**
  - [ ] Prometheus + Grafana
  - [ ] ELKæ—¥å¿—æ”¶é›†
  - [ ] APMæ€§èƒ½ç›‘æ§

#### æ—¶é—´èŠ‚ç‚¹ä¸äº¤ä»˜ç‰©
- **ç¬¬6-10å¤©**: ç¯å¢ƒæ­å»ºï¼ŒåŸºç¡€æœåŠ¡éƒ¨ç½²
- **ç¬¬11-14å¤©**: ç°æœ‰ç³»ç»Ÿé›†æˆæµ‹è¯•ï¼Œæ€§èƒ½åŸºå‡†æµ‹è¯•

#### äº¤ä»˜ç‰©
- [ ] å¼€å‘æµ‹è¯•ç¯å¢ƒéƒ¨ç½²æ–‡æ¡£
- [ ] æŠ€æœ¯é€‰å‹å¯¹æ¯”æŠ¥å‘Š
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•æŠ¥å‘Š
- [ ] CI/CDæµæ°´çº¿é…ç½®

---

## ç¬¬äºŒé˜¶æ®µï¼šæ ¸å¿ƒåŠŸèƒ½å¼€å‘ (6å‘¨)

### 2.1 æ•°æ®æ¨¡å‹é‡æ„ä¸ä¼˜åŒ– (1å‘¨)

#### æ•°æ®åº“å‡çº§æ–¹æ¡ˆ
```sql
-- è½¨è¿¹æ•°æ®è¡¨ä¼˜åŒ– (åŸºäºç°æœ‰t_user_health_dataæ‰©å±•)
ALTER TABLE t_user_health_data 
ADD COLUMN speed DOUBLE COMMENT 'é€Ÿåº¦(km/h)',
ADD COLUMN bearing DOUBLE COMMENT 'æ–¹å‘è§’(åº¦)', 
ADD COLUMN accuracy DOUBLE COMMENT 'å®šä½ç²¾åº¦(ç±³)',
ADD COLUMN geom POINT SRID 4326 COMMENT 'ç©ºé—´å‡ ä½•å¯¹è±¡',
ADD SPATIAL INDEX idx_geom (geom),
ADD INDEX idx_user_timestamp_covering (user_id, timestamp, latitude, longitude);

-- æŒ‰æœˆåˆ†è¡¨ç­–ç•¥
CREATE TABLE t_user_health_data_202401 LIKE t_user_health_data;
CREATE TABLE t_user_health_data_202402 LIKE t_user_health_data;
-- ... (è‡ªåŠ¨åˆ›å»ºåç»­æœˆä»½è¡¨)

-- ç”µå­å›´æ è¡¨å¢å¼º
ALTER TABLE t_geofence
ADD COLUMN fence_type ENUM('CIRCLE','RECTANGLE','POLYGON') DEFAULT 'POLYGON',
ADD COLUMN center_lng DECIMAL(10,7) COMMENT 'ä¸­å¿ƒç‚¹ç»åº¦',
ADD COLUMN center_lat DECIMAL(10,7) COMMENT 'ä¸­å¿ƒç‚¹çº¬åº¦', 
ADD COLUMN radius FLOAT COMMENT 'åŠå¾„(ç±³)',
ADD COLUMN geom GEOMETRY SRID 4326 COMMENT 'ç©ºé—´å‡ ä½•å¯¹è±¡',
ADD COLUMN alert_config JSON COMMENT 'å‘Šè­¦é…ç½®',
ADD SPATIAL INDEX idx_fence_geom (geom);

-- æ–°å¢å‘Šè­¦è®°å½•è¡¨
CREATE TABLE t_geofence_alert (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    fence_id BIGINT NOT NULL,
    user_id BIGINT NOT NULL,
    alert_type ENUM('ENTER','EXIT','STAY_TIMEOUT') NOT NULL,
    alert_level ENUM('LOW','MEDIUM','HIGH') NOT NULL,
    start_time TIMESTAMP NOT NULL,
    end_time TIMESTAMP,
    location_lng DECIMAL(10,7),
    location_lat DECIMAL(10,7),
    alert_status ENUM('PENDING','PROCESSING','RESOLVED','IGNORED') DEFAULT 'PENDING',
    handler_id BIGINT,
    handle_time TIMESTAMP,
    handle_note TEXT,
    notify_status JSON,
    created_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    
    INDEX idx_fence_time (fence_id, start_time),
    INDEX idx_user_time (user_id, start_time),
    INDEX idx_status (alert_status)
) COMMENT='å›´æ å‘Šè­¦è®°å½•è¡¨';

-- ç”¨æˆ·åœ¨çº¿çŠ¶æ€è¡¨
CREATE TABLE t_user_online_status (
    user_id BIGINT PRIMARY KEY,
    device_id VARCHAR(64),
    online_status ENUM('ONLINE','OFFLINE','ABNORMAL') NOT NULL,
    last_location_time TIMESTAMP,
    last_lng DECIMAL(10,7),
    last_lat DECIMAL(10,7), 
    heartbeat_interval INT DEFAULT 30,
    updated_time TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    INDEX idx_status (online_status),
    INDEX idx_update_time (updated_time)
) COMMENT='ç”¨æˆ·åœ¨çº¿çŠ¶æ€è¡¨';
```

#### ä»»åŠ¡åˆ†è§£
- [ ] **æ•°æ®è¿ç§»è„šæœ¬** (2å¤©)
  - [ ] å†å²æ•°æ®æ¸…æ´—ä¸è¿ç§» (åŸºäºç°æœ‰t_user_health_data)
  - [ ] ç©ºé—´ç´¢å¼•åˆ›å»ºä¸ä¼˜åŒ–
  - [ ] æ•°æ®å®Œæ•´æ€§éªŒè¯
  - [ ] **ä¸ä¿®æ”¹UnifiedHealthDataQueryServiceçš„æŸ¥è¯¢é€»è¾‘**

- [ ] **å®ä½“ç±»é‡æ„** (2å¤©)
  - [ ] æ‰©å±•TUserHealthDataå®ä½“ (æ·»åŠ speedã€bearingã€accuracyå­—æ®µ)
  - [ ] æ–°å»ºå‘Šè­¦ç›¸å…³å®ä½“ (ç‹¬ç«‹è¡¨ç»“æ„)
  - [ ] MyBatisæ˜ å°„é…ç½®æ›´æ–°
  - [ ] **ä¿æŒä¸UnifiedHealthDataQueryServiceçš„å…¼å®¹æ€§**

- [ ] **æ•°æ®è®¿é—®å±‚ä¼˜åŒ–** (1å¤©)
  - [ ] **éµå¾ªç°æœ‰UnifiedHealthDataQueryServiceçš„åˆ†è¡¨è·¯ç”±**
  - [ ] **å¤ç”¨ç°æœ‰æ‰¹é‡æŸ¥è¯¢ä¼˜åŒ–**
  - [ ] **å¤ç”¨ç°æœ‰ç¼“å­˜ç­–ç•¥**
  - [ ] è½¨è¿¹ä¸“ç”¨æŸ¥è¯¢å°è£… (åŸºäºqueryHealthDataç»“æœ)

#### äº¤ä»˜ç‰©
- [ ] æ•°æ®åº“å‡çº§è„šæœ¬
- [ ] æ•°æ®è¿ç§»éªŒè¯æŠ¥å‘Š
- [ ] æ–°å¢å®ä½“ç±»åŠMapper

### 2.2 åç«¯æ ¸å¿ƒæœåŠ¡å¼€å‘ (3å‘¨)

#### 2.2.1 è½¨è¿¹æœåŠ¡å¢å¼º (1å‘¨)

åŸºäºç°æœ‰çš„`UnifiedHealthDataQueryService`è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œ**ä¸¥æ ¼éµå¾ªé€šè¿‡queryHealthDataæ–¹æ³•æŸ¥è¯¢å¥åº·æ•°æ®çš„è§„èŒƒ**ï¼š

```java
@Service
public class TrackService {
    
    @Autowired
    private UnifiedHealthDataQueryService unifiedHealthDataQueryService;
    
    @Autowired
    private GeofenceCalculatorService geofenceCalculator;
    
    @Autowired
    private WebSocketService webSocketService;
    
    // å®æ—¶è½¨è¿¹å¤„ç†
    @Async("trackProcessExecutor")
    public void processRealtimeTrack(TrackUploadEvent event) {
        // 1. æ•°æ®éªŒè¯ä¸æ¸…æ´—
        TrackPoint point = validateAndCleanTrackPoint(event.getTrackPoint());
        
        // 2. è½¨è¿¹çº åç®—æ³•
        TrackPoint correctedPoint = trackFilter.filterPoint(point);
        
        // 3. å›´æ æ£€æµ‹
        List<GeofenceAlert> alerts = geofenceCalculator.checkGeofences(correctedPoint);
        
        // 4. å®æ—¶æ¨é€
        webSocketService.pushTrackUpdate(correctedPoint);
        
        // 5. å‘Šè­¦å¤„ç†
        if (!alerts.isEmpty()) {
            alertService.processAlerts(alerts);
        }
    }
    
    // å†å²è½¨è¿¹æŸ¥è¯¢ - å¿…é¡»é€šè¿‡UnifiedHealthDataQueryService.queryHealthData
    public List<TrackPoint> queryHistoryTrack(TrackQueryParams params) {
        // æ„å»ºUnifiedHealthQueryDTO
        UnifiedHealthQueryDTO queryDTO = new UnifiedHealthQueryDTO();
        queryDTO.setUserId(params.getUserId());
        queryDTO.setCustomerId(params.getCustomerId());
        queryDTO.setOrgId(params.getOrgId());
        queryDTO.setStartDate(params.getStartDate());
        queryDTO.setEndDate(params.getEndDate());
        queryDTO.setPage(params.getPage());
        queryDTO.setPageSize(params.getPageSize());
        
        // è°ƒç”¨ç»Ÿä¸€å¥åº·æ•°æ®æŸ¥è¯¢æœåŠ¡ (å¿…é¡»éµå¾ªçš„è§„èŒƒ)
        Map<String, Object> healthDataResult = unifiedHealthDataQueryService.queryHealthData(queryDTO);
        
        // ä»è¿”å›ç»“æœä¸­æå–åŸºç¡€æ•°æ®
        @SuppressWarnings("unchecked")
        List<Map<String, Object>> basicData = (List<Map<String, Object>>) healthDataResult.get("basicData");
        
        if (basicData == null || basicData.isEmpty()) {
            return Collections.emptyList();
        }
        
        // è½¬æ¢ä¸ºè½¨è¿¹ç‚¹æ ¼å¼
        List<TrackPoint> trackPoints = convertHealthDataToTrackPoints(basicData);
        
        // è½¨è¿¹æŠ½ç¨€å¤„ç†
        if (params.isSimplify() && trackPoints.size() > params.getMaxPoints()) {
            trackPoints = trackSimplifier.simplify(trackPoints, params.getTolerance());
        }
        
        return trackPoints;
    }
    
    // æ‰¹é‡æŸ¥è¯¢ç”¨æˆ·è½¨è¿¹ - ç”¨äºå®æ—¶ç›‘æ§
    public Map<String, List<TrackPoint>> queryMultiUserRecentTracks(List<Long> userIds, 
                                                                   Long customerId, 
                                                                   LocalDateTime since) {
        Map<String, List<TrackPoint>> result = new HashMap<>();
        
        for (Long userId : userIds) {
            try {
                // æ„å»ºæŸ¥è¯¢å‚æ•°
                UnifiedHealthQueryDTO queryDTO = new UnifiedHealthQueryDTO();
                queryDTO.setUserId(userId);
                queryDTO.setCustomerId(customerId);
                queryDTO.setStartDate(since);
                queryDTO.setEndDate(LocalDateTime.now());
                queryDTO.setPage(1);
                queryDTO.setPageSize(100); // æœ€è¿‘100ä¸ªç‚¹
                
                // é€šè¿‡ç»Ÿä¸€æŸ¥è¯¢æœåŠ¡è·å–æ•°æ®
                Map<String, Object> healthDataResult = unifiedHealthDataQueryService.queryHealthData(queryDTO);
                @SuppressWarnings("unchecked")
                List<Map<String, Object>> basicData = (List<Map<String, Object>>) healthDataResult.get("basicData");
                
                if (basicData != null && !basicData.isEmpty()) {
                    List<TrackPoint> trackPoints = convertHealthDataToTrackPoints(basicData);
                    result.put(userId.toString(), trackPoints);
                }
            } catch (Exception e) {
                log.error("æŸ¥è¯¢ç”¨æˆ·{}è½¨è¿¹å¤±è´¥: {}", userId, e.getMessage());
                result.put(userId.toString(), Collections.emptyList());
            }
        }
        
        return result;
    }
    
    // åœç•™ç‚¹è¯†åˆ«
    public List<StayPoint> detectStayPoints(List<TrackPoint> track) {
        return stayPointDetector.detect(track, STAY_DISTANCE_THRESHOLD, MIN_STAY_DURATION);
    }
    
    // ç§æœ‰æ–¹æ³•ï¼šå¥åº·æ•°æ®è½¬è½¨è¿¹ç‚¹
    private List<TrackPoint> convertHealthDataToTrackPoints(List<Map<String, Object>> healthData) {
        return healthData.stream()
            .filter(data -> data.get("latitude") != null && data.get("longitude") != null)
            .map(this::mapToTrackPoint)
            .sorted(Comparator.comparing(TrackPoint::getTimestamp))
            .collect(Collectors.toList());
    }
    
    private TrackPoint mapToTrackPoint(Map<String, Object> data) {
        TrackPoint point = new TrackPoint();
        point.setLatitude(getDoubleValue(data, "latitude"));
        point.setLongitude(getDoubleValue(data, "longitude"));
        point.setAltitude(getDoubleValue(data, "altitude"));
        point.setTimestamp(getTimestampValue(data, "timestamp"));
        
        // ä»distanceå­—æ®µæå–è·ç¦»ä¿¡æ¯
        if (data.get("distance") != null) {
            point.setDistance(getDoubleValue(data, "distance"));
        }
        
        return point;
    }
    
    private Double getDoubleValue(Map<String, Object> data, String key) {
        Object value = data.get(key);
        if (value == null) return null;
        if (value instanceof Number) {
            return ((Number) value).doubleValue();
        }
        try {
            return Double.parseDouble(value.toString());
        } catch (NumberFormatException e) {
            return null;
        }
    }
}
```

**å¼€å‘ä»»åŠ¡ï¼š**
- [ ] å®æ—¶è½¨è¿¹å¤„ç†æœåŠ¡ (2å¤©)
- [ ] è½¨è¿¹ç®—æ³•å®ç° (çº åã€æŠ½ç¨€ã€åœç•™æ£€æµ‹) (2å¤©)
- [ ] æ‰¹é‡ä¸Šä¼ APIä¼˜åŒ– (1å¤©)

#### 2.2.2 å›´æ è®¡ç®—å¼•æ“ (1å‘¨)

æ‰©å±•ç°æœ‰çš„`TGeofenceServiceImpl`ï¼š

```java
@Service
public class GeofenceCalculatorService extends TGeofenceServiceImpl {
    
    private final GeometryEngine geometryEngine;
    private final RedisTemplate<String, Object> redisTemplate;
    
    // å›´æ åˆ¤å®šå¼•æ“
    public List<GeofenceEvent> calculateGeofenceEvents(TrackPoint point) {
        List<GeofenceEvent> events = new ArrayList<>();
        
        // 1. ä»Redisè·å–é™„è¿‘å›´æ  (åœ°ç†ç´¢å¼•é¢„ç­›é€‰)
        List<String> nearbyFenceIds = getNearbyFences(point, 1000);
        
        // 2. æ‰¹é‡è·å–å›´æ è¯¦æƒ…
        List<TGeofence> fences = getFencesFromCache(nearbyFenceIds);
        
        // 3. ç²¾ç¡®è¾¹ç•Œæ£€æµ‹
        for (TGeofence fence : fences) {
            GeofenceEvent event = checkFenceBoundary(point, fence);
            if (event != null) {
                events.add(event);
            }
        }
        
        return events;
    }
    
    // ç©ºé—´ç´¢å¼•æŸ¥è¯¢
    private List<String> getNearbyFences(TrackPoint point, double radiusMeters) {
        return redisTemplate.opsForGeo()
            .radius("geofence_centers", 
                   point.getLongitude(), 
                   point.getLatitude(),
                   radiusMeters, 
                   RedisGeoCommands.DistanceUnit.METERS)
            .getContent()
            .stream()
            .map(result -> result.getContent().getName())
            .collect(Collectors.toList());
    }
}
```

**å¼€å‘ä»»åŠ¡ï¼š**
- [ ] ç©ºé—´è®¡ç®—å¼•æ“ (JTSé›†æˆ) (2å¤©)
- [ ] Redisåœ°ç†ç´¢å¼•ä¼˜åŒ– (1å¤©)
- [ ] å›´æ æ‰¹é‡ç®¡ç†API (2å¤©)

#### 2.2.3 å®æ—¶é€šä¿¡æœåŠ¡ (1å‘¨)

```java
@Component
public class TrackWebSocketHandler extends TextWebSocketHandler {
    
    private final ConcurrentHashMap<String, WebSocketSession> sessions = new ConcurrentHashMap<>();
    
    @Override
    public void afterConnectionEstablished(WebSocketSession session) {
        String userId = extractUserId(session);
        sessions.put(userId, session);
        
        // å‘é€å½“å‰åœ¨çº¿çŠ¶æ€
        sendOnlineStatus(session);
        
        // å‘é€æœ€è¿‘è½¨è¿¹
        sendRecentTrack(session, userId);
    }
    
    @EventListener
    public void onTrackUpdate(TrackUpdateEvent event) {
        String targetUserId = event.getUserId();
        WebSocketSession session = sessions.get(targetUserId);
        
        if (session != null && session.isOpen()) {
            sendTrackUpdate(session, event.getTrackPoint());
        }
    }
    
    @EventListener  
    public void onGeofenceAlert(GeofenceAlertEvent event) {
        // å¹¿æ’­å‘Šè­¦ç»™ç›¸å…³ç”¨æˆ·
        List<String> targetUsers = getAlertTargetUsers(event.getFenceId());
        
        for (String userId : targetUsers) {
            WebSocketSession session = sessions.get(userId);
            if (session != null && session.isOpen()) {
                sendAlert(session, event);
            }
        }
    }
}
```

**å¼€å‘ä»»åŠ¡ï¼š**
- [ ] WebSocketæœåŠ¡æ­å»º (2å¤©)
- [ ] æ¶ˆæ¯æ¨é€æœºåˆ¶ (2å¤©)  
- [ ] è¿æ¥ç®¡ç†ä¸å¿ƒè·³ (1å¤©)

### 2.3 å‰ç«¯ç»„ä»¶å¼€å‘ (2å‘¨)

#### 2.3.1 å®æ—¶ç›‘æ§ç•Œé¢é‡æ„ (1å‘¨)

åŸºäºç°æœ‰çš„`TrackMapComponent`å’Œ`TrackView`è¿›è¡Œå¢å¼ºï¼š

```typescript
// å®æ—¶ç›‘æ§ä¸»ç»„ä»¶
<template>
  <div class="realtime-monitor">
    <!-- åœ°å›¾åŒºåŸŸ -->
    <div class="map-container">
      <MapboxMap 
        ref="map"
        :center="mapCenter"
        :zoom="mapZoom"
        @load="onMapLoad"
      >
        <!-- ç”¨æˆ·ä½ç½®å›¾å±‚ -->
        <UserLocationLayer 
          :users="onlineUsers"
          :cluster="shouldCluster"
          @user-click="onUserClick"
        />
        
        <!-- å›´æ å›¾å±‚ -->
        <GeofenceLayer 
          :fences="activeFences"
          :editable="false"
          @fence-hover="onFenceHover"
        />
        
        <!-- è½¨è¿¹å›¾å±‚ -->
        <TrackLayer
          v-if="selectedUser"
          :tracks="userTracks"
          :animated="true"
        />
      </MapboxMap>
      
      <!-- åœ°å›¾æ§ä»¶ -->
      <MapControls 
        @locate="centerToUser"
        @fullscreen="toggleFullscreen"
        @layer-toggle="onLayerToggle"
      />
    </div>
    
    <!-- ä¾§è¾¹æ  -->
    <div class="sidebar">
      <!-- åœ¨çº¿ç”¨æˆ·åˆ—è¡¨ -->
      <UserListPanel 
        :users="onlineUsers"
        :selected="selectedUser"
        @user-select="onUserSelect"
        @user-locate="locateUser"
      />
      
      <!-- ç»Ÿè®¡é¢æ¿ -->
      <StatisticsPanel :stats="realtimeStats" />
    </div>
    
    <!-- å‘Šè­¦é¢æ¿ -->
    <AlertPanel 
      v-if="activeAlerts.length > 0"
      :alerts="activeAlerts"
      @alert-handle="handleAlert"
      @alert-dismiss="dismissAlert"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, reactive, onMounted, onUnmounted } from 'vue'
import { useWebSocket } from '@/composables/useWebSocket'
import { useMapbox } from '@/composables/useMapbox'

// WebSocketè¿æ¥
const { socket, isConnected, sendMessage } = useWebSocket('/ws/track')

// åœ°å›¾çŠ¶æ€
const { map, mapCenter, mapZoom } = useMapbox()

// å®æ—¶æ•°æ®
const onlineUsers = ref<UserLocation[]>([])
const activeAlerts = ref<Alert[]>([])
const realtimeStats = reactive({
  onlineCount: 0,
  todayAlerts: 0,
  lastUpdateTime: new Date()
})

// WebSocketäº‹ä»¶å¤„ç†
socket.on('user_location_update', (data: UserLocationUpdate) => {
  updateUserLocation(data)
})

socket.on('geofence_alert', (alert: Alert) => {
  activeAlerts.value.unshift(alert)
  showAlertNotification(alert)
})

// ç»„ä»¶æ–¹æ³•
const updateUserLocation = (update: UserLocationUpdate) => {
  const userIndex = onlineUsers.value.findIndex(u => u.userId === update.userId)
  if (userIndex >= 0) {
    onlineUsers.value[userIndex] = { ...onlineUsers.value[userIndex], ...update }
  } else {
    onlineUsers.value.push(update)
  }
  
  // æ›´æ–°ç»Ÿè®¡
  realtimeStats.onlineCount = onlineUsers.value.filter(u => u.status === 'online').length
  realtimeStats.lastUpdateTime = new Date()
}
</script>
```

**å¼€å‘ä»»åŠ¡ï¼š**
- [ ] å®æ—¶ç›‘æ§ç•Œé¢é‡æ„ (3å¤©)
- [ ] WebSocketé›†æˆä¸çŠ¶æ€ç®¡ç† (2å¤©)

#### 2.3.2 å†å²å›æ”¾ç»„ä»¶ (1å‘¨)

```typescript
// å†å²å›æ”¾ç»„ä»¶
<template>
  <div class="history-playback">
    <!-- æ§åˆ¶é¢æ¿ -->
    <div class="control-panel">
      <UserSelector v-model="selectedUser" :users="users" />
      <DateRangePicker v-model="dateRange" />
      
      <!-- æ’­æ”¾æ§åˆ¶ -->
      <PlaybackControls 
        v-model:playing="isPlaying"
        v-model:speed="playbackSpeed"
        v-model:progress="playbackProgress"
        :duration="trackDuration"
        @seek="seekToTime"
      />
    </div>
    
    <!-- åœ°å›¾æ˜¾ç¤º -->
    <div class="map-container">
      <MapboxMap ref="map">
        <!-- å†å²è½¨è¿¹ -->
        <HistoryTrackLayer 
          :track="currentTrack"
          :current-point="currentPoint"
          :show-stops="showStops"
        />
        
        <!-- å›´æ æ˜¾ç¤º -->
        <GeofenceLayer :fences="activeFences" />
      </MapboxMap>
    </div>
    
    <!-- ä¿¡æ¯é¢æ¿ -->
    <div class="info-panel">
      <TrackStats :stats="trackStats" />
      <EventsList :events="trackEvents" />
    </div>
    
    <!-- æ—¶é—´è½´ -->
    <TimelineSlider 
      v-model="playbackProgress"
      :duration="trackDuration"
      :markers="eventMarkers"
      @marker-click="jumpToEvent"
    />
  </div>
</template>

<script setup lang="ts">
import { ref, computed, watch } from 'vue'
import { useTrackPlayback } from '@/composables/useTrackPlayback'

const {
  selectedUser,
  dateRange,
  isPlaying,
  playbackSpeed,
  playbackProgress,
  currentTrack,
  currentPoint,
  trackStats,
  trackEvents,
  loadTrackData,
  play,
  pause,
  seekToTime
} = useTrackPlayback()

// ç›‘å¬ç”¨æˆ·å’Œæ—¶é—´èŒƒå›´å˜åŒ–
watch([selectedUser, dateRange], async ([user, range]) => {
  if (user && range) {
    await loadTrackData(user, range)
  }
})
</script>
```

**å¼€å‘ä»»åŠ¡ï¼š**
- [ ] å†å²å›æ”¾ç•Œé¢å¼€å‘ (3å¤©)
- [ ] æ—¶é—´è½´æ§åˆ¶ç»„ä»¶ (2å¤©)

### 2.4 å›´æ ç®¡ç†åŠŸèƒ½å®Œå–„ (1å‘¨)

åŸºäºç°æœ‰çš„å›´æ ç®¡ç†ç•Œé¢è¿›è¡ŒåŠŸèƒ½å¢å¼ºï¼š

```typescript
// å›´æ ç®¡ç†ç»„ä»¶å¢å¼º
<template>
  <div class="geofence-management">
    <!-- å·¥å…·æ  -->
    <div class="toolbar">
      <el-button type="primary" @click="createFence">
        <el-icon><Plus /></el-icon>
        æ–°å»ºå›´æ 
      </el-button>
      <el-button @click="batchImport">
        <el-icon><Upload /></el-icon>
        æ‰¹é‡å¯¼å…¥
      </el-button>
      <el-button 
        :disabled="!selectedFences.length"
        @click="batchDelete"
      >
        <el-icon><Delete /></el-icon>
        æ‰¹é‡åˆ é™¤
      </el-button>
    </div>
    
    <!-- ä¸»è¦å†…å®¹åŒº -->
    <div class="main-content">
      <!-- å›´æ åˆ—è¡¨ -->
      <div class="fence-list">
        <el-table 
          :data="fences"
          @selection-change="onSelectionChange"
          @row-click="selectFence"
        >
          <el-table-column type="selection" />
          <el-table-column prop="name" label="å›´æ åç§°" />
          <el-table-column prop="type" label="ç±»å‹">
            <template #default="{ row }">
              <el-tag :type="getFenceTypeTag(row.type)">
                {{ getFenceTypeLabel(row.type) }}
              </el-tag>
            </template>
          </el-table-column>
          <el-table-column prop="bindCount" label="ç»‘å®šç”¨æˆ·" />
          <el-table-column prop="status" label="çŠ¶æ€">
            <template #default="{ row }">
              <el-switch 
                v-model="row.active"
                @change="toggleFenceStatus(row)"
              />
            </template>
          </el-table-column>
          <el-table-column label="æ“ä½œ">
            <template #default="{ row }">
              <el-button size="small" @click="editFence(row)">ç¼–è¾‘</el-button>
              <el-button size="small" @click="bindUsers(row)">ç»‘å®š</el-button>
              <el-button 
                size="small" 
                type="danger" 
                @click="deleteFence(row)"
              >
                åˆ é™¤
              </el-button>
            </template>
          </el-table-column>
        </el-table>
      </div>
      
      <!-- åœ°å›¾é¢„è§ˆ -->
      <div class="map-preview">
        <MapboxMap ref="map" @load="onMapLoad">
          <!-- å›´æ ç»˜åˆ¶å·¥å…· -->
          <DrawControls 
            v-if="isCreating || isEditing"
            :mode="drawMode"
            @draw-complete="onDrawComplete"
          />
          
          <!-- å›´æ æ˜¾ç¤º -->
          <GeofenceLayer 
            :fences="displayFences"
            :selected="selectedFence"
            :editable="isEditing"
            @fence-click="selectFence"
            @fence-edit="onFenceEdit"
          />
        </MapboxMap>
      </div>
    </div>
    
    <!-- å›´æ ç¼–è¾‘å¼¹çª— -->
    <FenceEditDialog 
      v-model="showEditDialog"
      :fence="editingFence"
      @save="saveFence"
    />
    
    <!-- ç”¨æˆ·ç»‘å®šå¼¹çª— -->
    <UserBindDialog
      v-model="showBindDialog" 
      :fence="bindingFence"
      @save="saveFenceBinding"
    />
  </div>
</template>
```

**å¼€å‘ä»»åŠ¡ï¼š**
- [ ] å›´æ åˆ›å»ºä¸ç¼–è¾‘å¢å¼º (2å¤©)
- [ ] ç”¨æˆ·ç»‘å®šç®¡ç† (2å¤©)
- [ ] æ‰¹é‡æ“ä½œåŠŸèƒ½ (1å¤©)

---

## ç¬¬ä¸‰é˜¶æ®µï¼šç³»ç»Ÿé›†æˆä¸ä¼˜åŒ– (3å‘¨)

### 3.1 æ€§èƒ½ä¼˜åŒ– (1å‘¨)

#### æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–
- [ ] **æŸ¥è¯¢ä¼˜åŒ–** (2å¤©)
  - [ ] æ…¢æŸ¥è¯¢åˆ†æä¸ä¼˜åŒ–
  - [ ] ç´¢å¼•ç­–ç•¥è°ƒæ•´
  - [ ] åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–

- [ ] **ç¼“å­˜ç­–ç•¥** (2å¤©)
  - [ ] Redisç¼“å­˜å±‚è®¾è®¡
  - [ ] çƒ­ç‚¹æ•°æ®é¢„åŠ è½½
  - [ ] ç¼“å­˜å¤±æ•ˆç­–ç•¥

- [ ] **åˆ†è¡¨åˆ†åº“ç­–ç•¥** (1å¤©)
  - [ ] è½¨è¿¹æ•°æ®æŒ‰æœˆåˆ†è¡¨
  - [ ] è¯»å†™åˆ†ç¦»é…ç½®
  - [ ] æ•°æ®å½’æ¡£ç­–ç•¥

#### å‰ç«¯æ€§èƒ½ä¼˜åŒ–
- [ ] **æ¸²æŸ“ä¼˜åŒ–** (2å¤©)
  - [ ] å¤§æ•°æ®é‡ç‚¹èšåˆ
  - [ ] Canvasæ¸²æŸ“ä¼˜åŒ–
  - [ ] è™šæ‹Ÿæ»šåŠ¨å®ç°

- [ ] **èµ„æºä¼˜åŒ–** (1å¤©)
  - [ ] ä»£ç åˆ†å‰²ä¸æ‡’åŠ è½½
  - [ ] é™æ€èµ„æºCDN
  - [ ] å›¾ç‰‡å‹ç¼©ä¸æ ¼å¼ä¼˜åŒ–

### 3.2 å®‰å…¨åŠ å›º (1å‘¨)

#### æ•°æ®å®‰å…¨
- [ ] **ä½ç½®æ•°æ®åŠ å¯†** (2å¤©)
  - [ ] ä¼ è¾“å±‚åŠ å¯† (HTTPS/WSS)
  - [ ] å­˜å‚¨å±‚åŠ å¯† (AES)
  - [ ] æ•æ„Ÿæ•°æ®è„±æ•

- [ ] **è®¿é—®æ§åˆ¶** (2å¤©)
  - [ ] ç»†ç²’åº¦æƒé™æ§åˆ¶
  - [ ] APIè®¿é—®é™æµ
  - [ ] æ“ä½œå®¡è®¡æ—¥å¿—

- [ ] **å¤šç§Ÿæˆ·éš”ç¦»** (1å¤©)
  - [ ] æ•°æ®éš”ç¦»éªŒè¯
  - [ ] æƒé™è¾¹ç•Œæµ‹è¯•
  - [ ] ç§Ÿæˆ·æ•°æ®å¤‡ä»½

### 3.3 ç›‘æ§ä¸å‘Šè­¦ (1å‘¨)

#### ç³»ç»Ÿç›‘æ§
- [ ] **æ€§èƒ½ç›‘æ§** (2å¤©)
  - [ ] APMé›†æˆ (Skywalking)
  - [ ] è‡ªå®šä¹‰æŒ‡æ ‡æ”¶é›†
  - [ ] å®æ—¶æ€§èƒ½å¤§ç›˜

- [ ] **ä¸šåŠ¡ç›‘æ§** (2å¤©)
  - [ ] è½¨è¿¹ä¸Šä¼ ç›‘æ§
  - [ ] å›´æ äº‹ä»¶ç›‘æ§  
  - [ ] ç”¨æˆ·æ´»è·ƒåº¦ç›‘æ§

- [ ] **å‘Šè­¦é…ç½®** (1å¤©)
  - [ ] é˜ˆå€¼å‘Šè­¦è®¾ç½®
  - [ ] å‘Šè­¦é€šé“é…ç½®
  - [ ] å‘Šè­¦å‡çº§ç­–ç•¥

---

## ç¬¬å››é˜¶æ®µï¼šæµ‹è¯•ä¸éƒ¨ç½² (3å‘¨)

### 4.1 å…¨é¢æµ‹è¯• (2å‘¨)

#### åŠŸèƒ½æµ‹è¯• (1å‘¨)
- [ ] **å•å…ƒæµ‹è¯•** (2å¤©)
  - [ ] åç«¯æœåŠ¡å•æµ‹ (è¦†ç›–ç‡>80%)
  - [ ] å‰ç«¯ç»„ä»¶å•æµ‹
  - [ ] ç®—æ³•å‡½æ•°å•æµ‹

- [ ] **é›†æˆæµ‹è¯•** (2å¤©)
  - [ ] APIæ¥å£æµ‹è¯•
  - [ ] æ•°æ®åº“é›†æˆæµ‹è¯•
  - [ ] ç¬¬ä¸‰æ–¹æœåŠ¡é›†æˆæµ‹è¯•

- [ ] **ç«¯åˆ°ç«¯æµ‹è¯•** (1å¤©)
  - [ ] å…³é”®ä¸šåŠ¡æµç¨‹æµ‹è¯•
  - [ ] è·¨å¹³å°å…¼å®¹æ€§æµ‹è¯•
  - [ ] ç”¨æˆ·ä½“éªŒæµ‹è¯•

#### æ€§èƒ½æµ‹è¯• (1å‘¨)
- [ ] **å‹åŠ›æµ‹è¯•** (2å¤©)
  - [ ] å¹¶å‘ç”¨æˆ·æµ‹è¯• (ç›®æ ‡300å¹¶å‘)
  - [ ] æ•°æ®é‡å‹åŠ›æµ‹è¯•
  - [ ] é•¿æ—¶é—´ç¨³å®šæ€§æµ‹è¯•

- [ ] **æ€§èƒ½åŸºå‡†æµ‹è¯•** (2å¤©)
  - [ ] å“åº”æ—¶é—´æµ‹è¯•
  - [ ] ååé‡æµ‹è¯•
  - [ ] èµ„æºæ¶ˆè€—æµ‹è¯•

- [ ] **ä¸“é¡¹æµ‹è¯•** (1å¤©)
  - [ ] WebSocketé•¿è¿æ¥æµ‹è¯•
  - [ ] å¤§æ•°æ®é‡æ¸²æŸ“æµ‹è¯•
  - [ ] ç§»åŠ¨ç«¯æ€§èƒ½æµ‹è¯•

### 4.2 éƒ¨ç½²ä¸Šçº¿ (1å‘¨)

#### ç”Ÿäº§ç¯å¢ƒå‡†å¤‡
- [ ] **ç¯å¢ƒé…ç½®** (2å¤©)
  - [ ] ç”Ÿäº§æœåŠ¡å™¨é…ç½®
  - [ ] æ•°æ®åº“é›†ç¾¤éƒ¨ç½²
  - [ ] Redisé›†ç¾¤é…ç½®

- [ ] **å®‰å…¨é…ç½®** (1å¤©)
  - [ ] é˜²ç«å¢™è§„åˆ™é…ç½®
  - [ ] SSLè¯ä¹¦éƒ¨ç½²
  - [ ] è®¿é—®æ§åˆ¶é…ç½®

#### å‘å¸ƒéƒ¨ç½²
- [ ] **ç°åº¦å‘å¸ƒ** (2å¤©)
  - [ ] å°è§„æ¨¡ç”¨æˆ·éªŒè¯
  - [ ] é—®é¢˜ä¿®å¤ä¸è°ƒä¼˜
  - [ ] ç›‘æ§æŒ‡æ ‡éªŒè¯

- [ ] **å…¨é‡å‘å¸ƒ** (2å¤©)
  - [ ] å…¨ç”¨æˆ·å¼€æ”¾
  - [ ] å®æ—¶ç›‘æ§
  - [ ] åº”æ€¥å“åº”å‡†å¤‡

---

## ç¬¬äº”é˜¶æ®µï¼šè¿è¥æ”¯æŒ (æŒç»­)

### 5.1 ç”¨æˆ·åŸ¹è®­ä¸æ”¯æŒ

#### åŸ¹è®­è®¡åˆ’
- [ ] **ç®¡ç†å‘˜åŸ¹è®­** (1å¤©)
  - [ ] ç³»ç»ŸåŠŸèƒ½ä»‹ç»
  - [ ] æƒé™é…ç½®ç®¡ç†
  - [ ] é—®é¢˜æ’æŸ¥æŒ‡å—

- [ ] **æœ€ç»ˆç”¨æˆ·åŸ¹è®­** (1å¤©)
  - [ ] ç•Œé¢æ“ä½œè¯´æ˜
  - [ ] å¸¸ç”¨åŠŸèƒ½æ¼”ç¤º
  - [ ] é—®é¢˜åé¦ˆæ¸ é“

#### æ”¯æŒæ–‡æ¡£
- [ ] ç”¨æˆ·æ“ä½œæ‰‹å†Œ
- [ ] ç®¡ç†å‘˜æŒ‡å—
- [ ] é—®é¢˜æ’æŸ¥æŒ‡å—
- [ ] APIæ¥å£æ–‡æ¡£

### 5.2 æŒç»­ä¼˜åŒ–

#### æ•°æ®åˆ†æ
- [ ] ç”¨æˆ·è¡Œä¸ºåˆ†æ
- [ ] æ€§èƒ½æŒ‡æ ‡åˆ†æ
- [ ] ä¸šåŠ¡ä»·å€¼è¯„ä¼°

#### åŠŸèƒ½è¿­ä»£
- [ ] ç”¨æˆ·åé¦ˆæ”¶é›†
- [ ] éœ€æ±‚ä¼˜å…ˆçº§æ’åº
- [ ] ç‰ˆæœ¬è§„åˆ’åˆ¶å®š

---

## é¡¹ç›®è¿›åº¦è·Ÿè¸ª

### é‡Œç¨‹ç¢‘æ—¶é—´è¡¨

| é˜¶æ®µ | é‡Œç¨‹ç¢‘ | è®¡åˆ’æ—¶é—´ | å…³é”®äº¤ä»˜ç‰© | è´£ä»»äºº |
|-----|--------|----------|-----------|--------|
| **é˜¶æ®µ1** | é¡¹ç›®å¯åŠ¨å®Œæˆ | ç¬¬2å‘¨æœ« | ç¯å¢ƒæ­å»ºã€å›¢é˜Ÿç»„å»º | é¡¹ç›®ç»ç† |
| **é˜¶æ®µ2** | æ ¸å¿ƒåŠŸèƒ½å¼€å‘å®Œæˆ | ç¬¬8å‘¨æœ« | åç«¯æœåŠ¡ã€å‰ç«¯ç»„ä»¶ | æŠ€æœ¯è´Ÿè´£äºº |
| **é˜¶æ®µ3** | ç³»ç»Ÿä¼˜åŒ–å®Œæˆ | ç¬¬11å‘¨æœ« | æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨åŠ å›º | æ¶æ„å¸ˆ |
| **é˜¶æ®µ4** | æµ‹è¯•éƒ¨ç½²å®Œæˆ | ç¬¬14å‘¨æœ« | ç”Ÿäº§ç¯å¢ƒä¸Šçº¿ | DevOps |
| **é˜¶æ®µ5** | è¿è¥æ”¯æŒå°±ç»ª | ç¬¬15å‘¨æœ« | åŸ¹è®­æ–‡æ¡£ã€æ”¯æŒä½“ç³» | äº§å“ç»ç† |

### é£é™©ç®¡æ§

#### æŠ€æœ¯é£é™©
| é£é™©é¡¹ | å½±å“åº¦ | æ¦‚ç‡ | ç¼“è§£æªæ–½ | è´Ÿè´£äºº |
|--------|--------|------|----------|--------|
| å¤§æ•°æ®é‡æ€§èƒ½é—®é¢˜ | é«˜ | ä¸­ | æå‰å‹åŠ›æµ‹è¯•ï¼Œåˆ†æ­¥ä¼˜åŒ– | åç«¯è´Ÿè´£äºº |
| åœ°å›¾ç»„ä»¶å…¼å®¹æ€§ | ä¸­ | ä½ | å¤šæµè§ˆå™¨æµ‹è¯•ï¼Œé™çº§æ–¹æ¡ˆ | å‰ç«¯è´Ÿè´£äºº |
| ç¬¬ä¸‰æ–¹æœåŠ¡ä¾èµ– | ä¸­ | ä¸­ | å¤‡é€‰æ–¹æ¡ˆï¼ŒæœåŠ¡é™çº§ | æ¶æ„å¸ˆ |

#### ä¸šåŠ¡é£é™©
| é£é™©é¡¹ | å½±å“åº¦ | æ¦‚ç‡ | ç¼“è§£æªæ–½ | è´Ÿè´£äºº |
|--------|--------|------|----------|--------|
| ç”¨æˆ·æ¥å—åº¦ä¸é«˜ | é«˜ | ä¸­ | ç”¨æˆ·è°ƒç ”ï¼Œç•Œé¢ä¼˜åŒ– | äº§å“ç»ç† |
| æ•°æ®è¿ç§»é—®é¢˜ | é«˜ | ä½ | å……åˆ†æµ‹è¯•ï¼Œå›æ»šæ–¹æ¡ˆ | DBA |
| ä¸Šçº¿åæ€§èƒ½é—®é¢˜ | ä¸­ | ä¸­ | ç°åº¦å‘å¸ƒï¼Œå®æ—¶ç›‘æ§ | DevOps |

### è´¨é‡ä¿è¯

#### ä»£ç è´¨é‡æ ‡å‡†
- [ ] ä»£ç è¦†ç›–ç‡ > 80%
- [ ] ä»£ç è§„èŒƒæ£€æŸ¥é€šè¿‡
- [ ] å®‰å…¨æ¼æ´æ‰«æé€šè¿‡
- [ ] æ€§èƒ½åŸºå‡†è¾¾æ ‡

#### äº¤ä»˜æ ‡å‡†
- [ ] åŠŸèƒ½å®Œæ•´æ€§éªŒæ”¶é€šè¿‡
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- [ ] å®‰å…¨æµ‹è¯•é€šè¿‡
- [ ] ç”¨æˆ·ä½“éªŒéªŒæ”¶é€šè¿‡

### æˆåŠŸæŒ‡æ ‡

#### æŠ€æœ¯æŒ‡æ ‡
- **å“åº”æ—¶é—´**: é¦–å±åŠ è½½<2.5sï¼ŒæŸ¥è¯¢å“åº”<800ms
- **å¹¶å‘å¤„ç†**: æ”¯æŒ300ç”¨æˆ·åŒæ—¶åœ¨çº¿
- **ç³»ç»Ÿå¯ç”¨æ€§**: 99.9%çš„æœåŠ¡å¯ç”¨æ€§
- **æ•°æ®å‡†ç¡®æ€§**: è½¨è¿¹å®šä½ç²¾åº¦<10ç±³

#### ä¸šåŠ¡æŒ‡æ ‡
- **ç”¨æˆ·æ´»è·ƒåº¦**: æ—¥æ´»ç”¨æˆ·>70%
- **åŠŸèƒ½ä½¿ç”¨ç‡**: æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨ç‡>60%
- **é—®é¢˜å¤„ç†**: ç”¨æˆ·åé¦ˆé—®é¢˜24hå†…å“åº”
- **åŸ¹è®­æ•ˆæœ**: ç”¨æˆ·æ“ä½œç†Ÿç»ƒåº¦>80%

---

## èµ„æºé…ç½®

### äººåŠ›èµ„æº

| è§’è‰² | äººæ•° | å‚ä¸é˜¶æ®µ | æ ¸å¿ƒèŒè´£ |
|------|------|----------|----------|
| é¡¹ç›®ç»ç† | 1 | å…¨ç¨‹ | é¡¹ç›®ç®¡ç†ã€è¿›åº¦æ§åˆ¶ã€é£é™©ç®¡æ§ |
| æŠ€æœ¯æ¶æ„å¸ˆ | 1 | é˜¶æ®µ1-3 | æŠ€æœ¯é€‰å‹ã€æ¶æ„è®¾è®¡ã€æŠ€æœ¯è¯„å®¡ |
| åç«¯å¼€å‘ | 2 | é˜¶æ®µ2-4 | æœåŠ¡å¼€å‘ã€APIè®¾è®¡ã€æ€§èƒ½ä¼˜åŒ– |
| å‰ç«¯å¼€å‘ | 2 | é˜¶æ®µ2-4 | ç»„ä»¶å¼€å‘ã€ç•Œé¢è®¾è®¡ã€ç”¨æˆ·ä½“éªŒ |
| æµ‹è¯•å·¥ç¨‹å¸ˆ | 1 | é˜¶æ®µ3-4 | åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯•ã€è´¨é‡ä¿è¯ |
| DevOps | 1 | é˜¶æ®µ1,4-5 | ç¯å¢ƒæ­å»ºã€éƒ¨ç½²è¿ç»´ã€ç›‘æ§å‘Šè­¦ |
| äº§å“ç»ç† | 1 | é˜¶æ®µ1,5 | éœ€æ±‚ç®¡ç†ã€ç”¨æˆ·éªŒæ”¶ã€è¿è¥æ”¯æŒ |

### æŠ€æœ¯èµ„æº

#### ç¡¬ä»¶èµ„æº
- **å¼€å‘ç¯å¢ƒ**: 8æ ¸16GæœåŠ¡å™¨ x3
- **æµ‹è¯•ç¯å¢ƒ**: ä¸ç”Ÿäº§åŒé…ç½®
- **ç”Ÿäº§ç¯å¢ƒ**: 16æ ¸32GæœåŠ¡å™¨ x5 (æ”¯æŒ1000ç”¨æˆ·)

#### è½¯ä»¶èµ„æº
- **å¼€å‘å·¥å…·**: IDEAã€VSCodeã€Gitç­‰
- **æµ‹è¯•å·¥å…·**: JMeterã€Seleniumã€Jestç­‰
- **ç›‘æ§å·¥å…·**: Prometheusã€Grafanaã€ELKç­‰
- **ç¬¬ä¸‰æ–¹æœåŠ¡**: åœ°å›¾APIã€çŸ­ä¿¡æœåŠ¡ç­‰

### é¢„ç®—ä¼°ç®—

| ç±»åˆ« | é¡¹ç›® | è´¹ç”¨ä¼°ç®— | å¤‡æ³¨ |
|------|------|----------|------|
| äººåŠ›æˆæœ¬ | å¼€å‘å›¢é˜Ÿ(7äººx3.5æœˆ) | Â¥420,000 | åŒ…å«è–ªèµ„å’Œç¤¾ä¿ |
| ç¡¬ä»¶è®¾å¤‡ | æœåŠ¡å™¨ã€ç½‘ç»œè®¾å¤‡ | Â¥80,000 | 3å¹´æŠ˜æ—§ |
| è½¯ä»¶æˆæƒ | å¼€å‘å·¥å…·ã€ç¬¬ä¸‰æ–¹æœåŠ¡ | Â¥30,000 | å¹´è´¹ |
| å…¶ä»–è´¹ç”¨ | åŸ¹è®­ã€å·®æ—…ã€æ‚è´¹ | Â¥20,000 | æœºåŠ¨è´¹ç”¨ |
| **æ€»è®¡** | - | **Â¥550,000** | çº¦55ä¸‡å…ƒ |

---

## æ€»ç»“

æœ¬å®æ–½æ–¹æ¡ˆåŸºäºç°æœ‰çš„çµå¢ƒä¸‡è±¡ç³»ç»ŸåŸºç¡€è®¾æ–½ï¼Œé‡‡ç”¨æ¸è¿›å¼å‡çº§çš„ç­–ç•¥ï¼Œæœ€å¤§åŒ–å¤ç”¨ç°æœ‰æŠ•èµ„ï¼ŒåŒæ—¶ç¡®ä¿ç³»ç»Ÿçš„å…ˆè¿›æ€§å’Œå¯æ‰©å±•æ€§ã€‚

### æ ¸å¿ƒä»·å€¼
1. **æŠ€æœ¯å…ˆè¿›æ€§**: é‡‡ç”¨ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼Œæ”¯æŒå¤§è§„æ¨¡ç”¨æˆ·è®¿é—®
2. **ä¸šåŠ¡å®Œæ•´æ€§**: è¦†ç›–è½¨è¿¹ç›‘æ§åˆ°å›´æ ç®¡ç†çš„å…¨ä¸šåŠ¡æµç¨‹
3. **ç”¨æˆ·ä½“éªŒ**: ç›´è§‚çš„ç•Œé¢è®¾è®¡å’Œæµç•…çš„æ“ä½œä½“éªŒ
4. **ç³»ç»Ÿå¯é æ€§**: é«˜å¯ç”¨æ¶æ„è®¾è®¡å’Œå®Œå–„çš„ç›‘æ§ä½“ç³»
5. **æŠ•èµ„ä¿æŠ¤**: æœ€å¤§åŒ–å¤ç”¨ç°æœ‰ç³»ç»Ÿå’ŒæŠ•èµ„

### é¢„æœŸæ•ˆæœ
- **æå‡ç®¡ç†æ•ˆç‡**: å®æ—¶ç›‘æ§é™ä½äººå·¥å·¡æ£€æˆæœ¬30%
- **å¢å¼ºå®‰å…¨ä¿éšœ**: å›´æ å‘Šè­¦åŠæ—¶å‘ç°å¼‚å¸¸æƒ…å†µ
- **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ**: ç»Ÿä¸€çš„è½¨è¿¹ç®¡ç†å’Œåˆ†æå¹³å°
- **æ”¯æ’‘ä¸šåŠ¡å¢é•¿**: å¯æ‰©å±•æ¶æ„æ”¯æŒæœªæ¥ä¸šåŠ¡å‘å±•

é€šè¿‡14å‘¨çš„ç´§å¯†å¼€å‘å’Œ1å‘¨çš„è¿è¥å‡†å¤‡ï¼Œå°†äº¤ä»˜ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€æ€§èƒ½ä¼˜å¼‚ã€ç”¨æˆ·å‹å¥½çš„è¿åŠ¨è½¨è¿¹ä¸ç”µå­å›´æ ç³»ç»Ÿï¼Œä¸ºä¼ä¸šçš„æ•°å­—åŒ–ç®¡ç†æä¾›å¼ºæœ‰åŠ›çš„æŠ€æœ¯æ”¯æ’‘ã€‚