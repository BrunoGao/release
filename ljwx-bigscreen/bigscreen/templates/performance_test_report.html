<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ æ€§èƒ½å‹åŠ›æµ‹è¯•ä¸­å¿ƒ</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;} /*å…¨å±€é‡ç½®*/
        body{font-family:'Microsoft YaHei',sans-serif;background:linear-gradient(135deg,#0c1445,#1e3c72,#2a5298);color:#fff;min-height:100vh;overflow-x:hidden;}
        
        /*ç²’å­èƒŒæ™¯*/
        .particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:1;}
        .particle{position:absolute;width:4px;height:4px;background:#64ffda;border-radius:50%;opacity:0.6;animation:float 6s infinite ease-in-out;}
        @keyframes float{0%,100%{transform:translateY(0) rotate(0deg);}50%{transform:translateY(-20px) rotate(180deg);}}
        
        /*ä¸»å®¹å™¨*/
        .container{position:relative;z-index:2;max-width:1400px;margin:0 auto;padding:20px;}
        
        /*å¤´éƒ¨*/
        .header{text-align:center;margin-bottom:40px;padding:30px;background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);border-radius:20px;border:1px solid rgba(100,255,218,0.3);box-shadow:0 20px 40px rgba(0,0,0,0.3);}
        .header h1{font-size:3em;color:#64ffda;text-shadow:0 0 30px rgba(100,255,218,0.8);margin-bottom:10px;animation:glow 2s ease-in-out infinite alternate;}
        @keyframes glow{from{text-shadow:0 0 20px rgba(100,255,218,0.5);}to{text-shadow:0 0 40px rgba(100,255,218,1);}}
        .header p{font-size:1.2em;color:#a0c4ff;opacity:0.9;}
        
        /*æ§åˆ¶é¢æ¿*/
        .control-panel{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:40px;}
        .control-card{background:rgba(255,255,255,0.08);backdrop-filter:blur(15px);border-radius:15px;padding:25px;border:1px solid rgba(100,255,218,0.2);transition:all 0.3s ease;position:relative;overflow:hidden;}
        .control-card:hover{transform:translateY(-5px);box-shadow:0 15px 35px rgba(100,255,218,0.2);border-color:rgba(100,255,218,0.5);}
        .control-card::before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(100,255,218,0.1),transparent);transition:left 0.5s;}
        .control-card:hover::before{left:100%;}
        
        .card-title{font-size:1.4em;color:#64ffda;margin-bottom:15px;display:flex;align-items:center;gap:10px;}
        .card-icon{font-size:1.5em;animation:pulse 2s infinite;}
        @keyframes pulse{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}
        
        /*æŒ‰é’®æ ·å¼*/
        .btn{padding:12px 25px;border:none;border-radius:8px;cursor:pointer;font-size:1em;font-weight:bold;transition:all 0.3s ease;text-transform:uppercase;letter-spacing:1px;position:relative;overflow:hidden;}
        .btn-primary{background:linear-gradient(45deg,#64ffda,#4fc3f7);color:#0c1445;}
        .btn-danger{background:linear-gradient(45deg,#f44336,#e91e63);color:#fff;}
        .btn:hover{transform:translateY(-2px);box-shadow:0 10px 25px rgba(0,0,0,0.3);}
        .btn:active{transform:translateY(0);}
        .btn::before{content:'';position:absolute;top:50%;left:50%;width:0;height:0;background:rgba(255,255,255,0.3);border-radius:50%;transition:all 0.3s ease;transform:translate(-50%,-50%);}
        .btn:active::before{width:100%;height:100%;}
        
        /*çŠ¶æ€æŒ‡ç¤ºå™¨*/
        .status-indicator{display:inline-flex;align-items:center;gap:8px;margin-top:15px;padding:8px 15px;border-radius:20px;font-size:0.9em;font-weight:bold;}
        .status-running{background:rgba(255,193,7,0.2);color:#ffc107;border:1px solid rgba(255,193,7,0.5);}
        .status-completed{background:rgba(76,175,80,0.2);color:#4caf50;border:1px solid rgba(76,175,80,0.5);}
        .status-idle{background:rgba(158,158,158,0.2);color:#9e9e9e;border:1px solid rgba(158,158,158,0.5);}
        
        /*ç»“æœé¢æ¿*/
        .result-panel{background:rgba(255,255,255,0.05);backdrop-filter:blur(20px);border-radius:20px;padding:30px;border:1px solid rgba(100,255,218,0.2);margin-top:30px;min-height:400px;}
        .result-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding-bottom:15px;border-bottom:1px solid rgba(100,255,218,0.3);}
        .result-title{font-size:1.6em;color:#64ffda;}
        .refresh-btn{background:rgba(100,255,218,0.2);border:1px solid rgba(100,255,218,0.5);color:#64ffda;padding:8px 15px;border-radius:8px;cursor:pointer;transition:all 0.3s ease;}
        .refresh-btn:hover{background:rgba(100,255,218,0.3);transform:rotate(180deg);}
        
        /*åŠ è½½åŠ¨ç”»*/
        .loading{display:flex;flex-direction:column;align-items:center;justify-content:center;height:300px;}
        .loading-spinner{width:60px;height:60px;border:4px solid rgba(100,255,218,0.2);border-top:4px solid #64ffda;border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px;}
        @keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
        .loading-text{color:#64ffda;font-size:1.2em;animation:fade 1.5s ease-in-out infinite alternate;}
        @keyframes fade{from{opacity:0.5;}to{opacity:1;}}
        
        /*æŠ¥å‘Šå†…å®¹*/
        .report-content{color:#fff;}
        .report-content .container{max-width:none;padding:0;}
        
        /*å“åº”å¼è®¾è®¡*/
        @media(max-width:768px){
            .control-panel{grid-template-columns:1fr;}
            .header h1{font-size:2em;}
            .container{padding:15px;}
        }
        
        /*æˆåŠŸåŠ¨ç”»*/
        .success-animation{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(76,175,80,0.9);color:#fff;padding:20px 30px;border-radius:10px;font-size:1.2em;z-index:1000;opacity:0;animation:successPop 2s ease-in-out;}
        @keyframes successPop{0%{opacity:0;transform:translate(-50%,-50%) scale(0.5);}20%{opacity:1;transform:translate(-50%,-50%) scale(1.1);}80%{opacity:1;transform:translate(-50%,-50%) scale(1);}100%{opacity:0;transform:translate(-50%,-50%) scale(0.9);}}
        
        /*ç¾åŒ–å¼¹å‡ºæ¡†åŠ¨ç”»*/
        @keyframes fadeIn{from{opacity:0;}to{opacity:1;}}
        @keyframes fadeOut{from{opacity:1;}to{opacity:0;}}
        @keyframes slideIn{from{transform:translateY(-30px);opacity:0;}to{transform:translateY(0);opacity:1;}}
    </style>
</head>
<body>
    <!--ç²’å­èƒŒæ™¯-->
    <div class="particles" id="particles"></div>
    
    <div class="container">
        <!--å¤´éƒ¨-->
        <div class="header">
            <h1>ğŸš€ æ€§èƒ½å‹åŠ›æµ‹è¯•ä¸­å¿ƒ</h1>
            <p>æ¢ç´¢ç³»ç»Ÿæé™ Â· ä¼˜åŒ–æ€§èƒ½è¡¨ç° Â· ä¿éšœæœåŠ¡ç¨³å®š</p>
        </div>
        
        <!--æ§åˆ¶é¢æ¿-->
        <div class="control-panel">
            <!--å¸¸è§„æµ‹è¯•-->
            <div class="control-card">
                <div class="card-title">
                    <span class="card-icon">âš¡</span>
                    å¸¸è§„æ€§èƒ½æµ‹è¯•
                </div>
                <p style="color:#a0c4ff;margin-bottom:20px;">æµ‹è¯•1000è®¾å¤‡å¹¶å‘ä¸Šä¼ ï¼Œç›®æ ‡3ç§’å†…å®Œæˆï¼ŒéªŒè¯ç³»ç»ŸåŸºç¡€æ€§èƒ½æŒ‡æ ‡ã€‚</p>
                <button class="btn btn-primary" onclick="startTest('normal')">å¯åŠ¨å¸¸è§„æµ‹è¯•</button>
                <div class="status-indicator status-idle" id="normalStatus">
                    <span>âšª</span> å¾…æœºä¸­
                </div>
            </div>
            
            <!--æé™æµ‹è¯•-->
            <div class="control-card">
                <div class="card-title">
                    <span class="card-icon">ğŸ”¥</span>
                    æé™å‹åŠ›æµ‹è¯•
                </div>
                <p style="color:#a0c4ff;margin-bottom:20px;">é€æ­¥å¢åŠ è´Ÿè½½è‡³ä¸‡çº§å¹¶å‘ï¼Œå¯»æ‰¾ç³»ç»Ÿæ€§èƒ½ç“¶é¢ˆå’Œæé™æ‰¿è½½èƒ½åŠ›ã€‚</p>
                <button class="btn btn-danger" onclick="startTest('extreme')">å¯åŠ¨æé™æµ‹è¯•</button>
                <div class="status-indicator status-idle" id="extremeStatus">
                    <span>âšª</span> å¾…æœºä¸­
                </div>
            </div>
        </div>
        
        <!--ç»“æœé¢æ¿-->
        <div class="result-panel">
            <div class="result-header">
                <div class="result-title">ğŸ“Š æµ‹è¯•æŠ¥å‘Š</div>
                <button class="refresh-btn" onclick="refreshReport()">ğŸ”„ åˆ·æ–°</button>
            </div>
            <div id="reportContent">
                <div class="loading">
                    <div style="text-align:center;color:#64ffda;">
                        <div style="font-size:4em;margin-bottom:20px;">ğŸ“ˆ</div>
                        <h3>ç­‰å¾…æµ‹è¯•å¯åŠ¨</h3>
                        <p style="margin-top:10px;color:#a0c4ff;">é€‰æ‹©æµ‹è¯•ç±»å‹å¼€å§‹æ€§èƒ½è¯„ä¼°</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script>
        //åˆ›å»ºç²’å­èƒŒæ™¯
        function createParticles(){
            const container=document.getElementById('particles');
            for(let i=0;i<50;i++){
                const particle=document.createElement('div');
                particle.className='particle';
                particle.style.left=Math.random()*100+'%';
                particle.style.top=Math.random()*100+'%';
                particle.style.animationDelay=Math.random()*6+'s';
                particle.style.animationDuration=(Math.random()*3+3)+'s';
                container.appendChild(particle);
            }
        }
        
        //å¯åŠ¨æµ‹è¯•
        async function startTest(type){
            const statusId=type+'Status';
            const statusEl=document.getElementById(statusId);
            
            //æ›´æ–°çŠ¶æ€
            statusEl.className='status-indicator status-running';
            statusEl.innerHTML='<span>ğŸŸ¡</span> æµ‹è¯•ä¸­...';
            
            //æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            document.getElementById('reportContent').innerHTML=`
                <div class="loading">
                    <div class="loading-spinner"></div>
                    <div class="loading-text">${type==='extreme'?'æé™':'å¸¸è§„'}æµ‹è¯•è¿›è¡Œä¸­...</div>
                    <p style="color:#a0c4ff;margin-top:10px;">è¯·è€å¿ƒç­‰å¾…æµ‹è¯•å®Œæˆ</p>
                </div>
            `;
            
            try{
                const response=await fetch('/api/performance_test/start',{
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body:JSON.stringify({type:type})
                });
                
                const result=await response.json();
                if(result.success){
                    showSuccess(result.message);
                    //å¼€å§‹è½®è¯¢çŠ¶æ€
                    pollTestStatus(statusId);
                }else{
                    throw new Error(result.error);
                }
            }catch(error){
                statusEl.className='status-indicator status-idle';
                statusEl.innerHTML='<span>ğŸ”´</span> å¯åŠ¨å¤±è´¥';
                showCustomAlert('å¯åŠ¨æµ‹è¯•å¤±è´¥: '+error.message);
            }
        }
        
        //è½®è¯¢æµ‹è¯•çŠ¶æ€
        async function pollTestStatus(statusId){
            const statusEl=document.getElementById(statusId);
            
            const poll=async()=>{
                try{
                    const response=await fetch('/api/performance_test/status');
                    const result=await response.json();
                    
                    if(result.success){
                        if(result.status==='completed'){
                            statusEl.className='status-indicator status-completed';
                            statusEl.innerHTML='<span>ğŸŸ¢</span> å·²å®Œæˆ';
                            
                            //æ˜¾ç¤ºæŠ¥å‘Š
                            document.getElementById('reportContent').innerHTML=
                                '<div class="report-content">'+result.report+'</div>';
                            
                            showSuccess('æµ‹è¯•å®Œæˆï¼æŠ¥å‘Šå·²ç”Ÿæˆ');
                            return;
                        }
                    }
                }catch(error){
                    console.error('è½®è¯¢çŠ¶æ€å¤±è´¥:',error);
                }
                
                //3ç§’åå†æ¬¡è½®è¯¢
                setTimeout(poll,3000);
            };
            
            setTimeout(poll,3000);
        }
        
        //åˆ·æ–°æŠ¥å‘Š
        async function refreshReport(){
            const btn=document.querySelector('.refresh-btn');
            btn.style.transform='rotate(360deg)';
            
            try{
                const response=await fetch('/api/performance_test/status');
                const result=await response.json();
                
                if(result.success&&result.status==='completed'){
                    document.getElementById('reportContent').innerHTML=
                        '<div class="report-content">'+result.report+'</div>';
                }
            }catch(error){
                console.error('åˆ·æ–°å¤±è´¥:',error);
            }finally{
                setTimeout(()=>btn.style.transform='rotate(0deg)',300);
            }
        }
        
        //æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
        function showSuccess(message){
            const div=document.createElement('div');
            div.className='success-animation';
            div.textContent=message;
            document.body.appendChild(div);
            setTimeout(()=>document.body.removeChild(div),2000);
        }
        
        //ç¾åŒ–å¼¹å‡ºæ¡†
        function showCustomAlert(msg, cb){
            const d=document.createElement('div'),b=document.createElement('button');
            d.style='position:fixed;top:0;left:0;width:100vw;height:100vh;z-index:99999;display:flex;align-items:center;justify-content:center;background:rgba(0,21,41,0.8);backdrop-filter:blur(5px);animation:fadeIn 0.3s ease;';
            d.innerHTML=`<div style="background:linear-gradient(135deg,rgba(10,24,48,0.98),rgba(0,21,41,0.95));border-radius:15px;box-shadow:0 0 30px rgba(100,255,218,0.3),0 0 60px rgba(100,255,218,0.1);padding:35px 40px;min-width:350px;max-width:450px;color:#fff;display:flex;flex-direction:column;align-items:center;border:1px solid rgba(100,255,218,0.2);animation:slideIn 0.3s ease;"><div style="font-size:20px;margin-bottom:25px;text-align:center;line-height:1.4;">${msg}</div></div>`;
            b.textContent='ç¡®å®š';b.style='margin:10px auto 0 auto;padding:10px 35px;font-size:16px;color:#00e4ff;background:rgba(100,255,218,0.1);border:1.5px solid #00e4ff;border-radius:8px;cursor:pointer;transition:all 0.3s ease;font-weight:500;';
            b.onmouseover=()=>b.style.background='rgba(100,255,218,0.2)';
            b.onmouseout=()=>b.style.background='rgba(100,255,218,0.1)';
            b.onclick=()=>{d.style.animation='fadeOut 0.3s ease';setTimeout(()=>d.remove(),300);cb&&cb();};
            d.querySelector('div').appendChild(b);
            document.body.appendChild(d);
        }
        
        //åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded',()=>{
            createParticles();
            refreshReport();//åŠ è½½å·²æœ‰æŠ¥å‘Š
        });
    </script>
</body>
</html> 